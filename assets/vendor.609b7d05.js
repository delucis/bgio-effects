var ft,k,Sr,He,Or,Cr,ht={},kr=[],Io=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ve(t,e){for(var n in e)t[n]=e[n];return t}function xr(t){var e=t.parentNode;e&&e.removeChild(t)}function No(t,e,n){var r,s,i,o={};for(i in e)i=="key"?r=e[i]:i=="ref"?s=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?ft.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)o[i]===void 0&&(o[i]=t.defaultProps[i]);return dt(t,o,r,s,null)}function dt(t,e,n,r,s){var i={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++Sr};return s==null&&k.vnode!=null&&k.vnode(i),i}function pt(t){return t.children}function yt(t,e){this.props=t,this.context=e}function Me(t,e){if(e==null)return t.__?Me(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Me(t):null}function Ar(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ar(t)}}function Mr(t){(!t.__d&&(t.__d=!0)&&He.push(t)&&!mt.__r++||Cr!==k.debounceRendering)&&((Cr=k.debounceRendering)||Or)(mt)}function mt(){for(var t;mt.__r=He.length;)t=He.sort(function(e,n){return e.__v.__b-n.__v.__b}),He=[],t.some(function(e){var n,r,s,i,o,a;e.__d&&(o=(i=(n=e).__v).__e,(a=n.__P)&&(r=[],(s=ve({},i)).__v=i.__v+1,cn(a,i,s,n.__n,a.ownerSVGElement!==void 0,i.__h!=null?[o]:null,r,o??Me(i),i.__h),Lr(r,i),i.__e!=o&&Ar(i)))})}function Ir(t,e,n,r,s,i,o,a,c,f){var u,d,y,p,v,E,_,P=r&&r.__k||kr,g=P.length;for(n.__k=[],u=0;u<e.length;u++)if((p=n.__k[u]=(p=e[u])==null||typeof p=="boolean"?null:typeof p=="string"||typeof p=="number"||typeof p=="bigint"?dt(null,p,null,null,p):Array.isArray(p)?dt(pt,{children:p},null,null,null):p.__b>0?dt(p.type,p.props,p.key,null,p.__v):p)!=null){if(p.__=n,p.__b=n.__b+1,(y=P[u])===null||y&&p.key==y.key&&p.type===y.type)P[u]=void 0;else for(d=0;d<g;d++){if((y=P[d])&&p.key==y.key&&p.type===y.type){P[d]=void 0;break}y=null}cn(t,p,y=y||ht,s,i,o,a,c,f),v=p.__e,(d=p.ref)&&y.ref!=d&&(_||(_=[]),y.ref&&_.push(y.ref,null,p),_.push(d,p.__c||v,p)),v!=null?(E==null&&(E=v),typeof p.type=="function"&&p.__k===y.__k?p.__d=c=Nr(p,c,t):c=Tr(t,p,y,P,v,c),typeof n.type=="function"&&(n.__d=c)):c&&y.__e==c&&c.parentNode!=t&&(c=Me(y))}for(n.__e=E,u=g;u--;)P[u]!=null&&(typeof n.type=="function"&&P[u].__e!=null&&P[u].__e==n.__d&&(n.__d=Me(r,u+1)),jr(P[u],P[u]));if(_)for(u=0;u<_.length;u++)Br(_[u],_[++u],_[++u])}function Nr(t,e,n){for(var r,s=t.__k,i=0;s&&i<s.length;i++)(r=s[i])&&(r.__=t,e=typeof r.type=="function"?Nr(r,e,n):Tr(n,r,r,s,r.__e,e));return e}function Tr(t,e,n,r,s,i){var o,a,c;if(e.__d!==void 0)o=e.__d,e.__d=void 0;else if(n==null||s!=i||s.parentNode==null)e:if(i==null||i.parentNode!==t)t.appendChild(s),o=null;else{for(a=i,c=0;(a=a.nextSibling)&&c<r.length;c+=2)if(a==s)break e;t.insertBefore(s,i),o=i}return o!==void 0?o:s.nextSibling}function To(t,e,n,r,s){var i;for(i in n)i==="children"||i==="key"||i in e||vt(t,i,null,n[i],r);for(i in e)s&&typeof e[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||n[i]===e[i]||vt(t,i,e[i],n[i],r)}function Dr(t,e,n){e[0]==="-"?t.setProperty(e,n):t[e]=n==null?"":typeof n!="number"||Io.test(e)?n:n+"px"}function vt(t,e,n,r,s){var i;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||Dr(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||Dr(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?r||t.addEventListener(e,i?$r:Rr,i):t.removeEventListener(e,i?$r:Rr,i);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,n):t.removeAttribute(e))}}function Rr(t){this.l[t.type+!1](k.event?k.event(t):t)}function $r(t){this.l[t.type+!0](k.event?k.event(t):t)}function cn(t,e,n,r,s,i,o,a,c){var f,u,d,y,p,v,E,_,P,g,C,w=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(c=n.__h,a=e.__e=n.__e,e.__h=null,i=[a]),(f=k.__b)&&f(e);try{e:if(typeof w=="function"){if(_=e.props,P=(f=w.contextType)&&r[f.__c],g=f?P?P.props.value:f.__:r,n.__c?E=(u=e.__c=n.__c).__=u.__E:("prototype"in w&&w.prototype.render?e.__c=u=new w(_,g):(e.__c=u=new yt(_,g),u.constructor=w,u.render=Ro),P&&P.sub(u),u.props=_,u.state||(u.state={}),u.context=g,u.__n=r,d=u.__d=!0,u.__h=[]),u.__s==null&&(u.__s=u.state),w.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=ve({},u.__s)),ve(u.__s,w.getDerivedStateFromProps(_,u.__s))),y=u.props,p=u.state,d)w.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(w.getDerivedStateFromProps==null&&_!==y&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(_,g),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(_,u.__s,g)===!1||e.__v===n.__v){u.props=_,u.state=u.__s,e.__v!==n.__v&&(u.__d=!1),u.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(V){V&&(V.__=e)}),u.__h.length&&o.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(_,u.__s,g),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(y,p,v)})}u.context=g,u.props=_,u.state=u.__s,(f=k.__r)&&f(e),u.__d=!1,u.__v=e,u.__P=t,f=u.render(u.props,u.state,u.context),u.state=u.__s,u.getChildContext!=null&&(r=ve(ve({},r),u.getChildContext())),d||u.getSnapshotBeforeUpdate==null||(v=u.getSnapshotBeforeUpdate(y,p)),C=f!=null&&f.type===pt&&f.key==null?f.props.children:f,Ir(t,Array.isArray(C)?C:[C],e,n,r,s,i,o,a,c),u.base=e.__e,e.__h=null,u.__h.length&&o.push(u),E&&(u.__E=u.__=null),u.__e=!1}else i==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Do(n.__e,e,n,r,s,i,o,c);(f=k.diffed)&&f(e)}catch(V){e.__v=null,(c||i!=null)&&(e.__e=a,e.__h=!!c,i[i.indexOf(a)]=null),k.__e(V,e,n)}}function Lr(t,e){k.__c&&k.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(r){r.call(n)})}catch(r){k.__e(r,n.__v)}})}function Do(t,e,n,r,s,i,o,a){var c,f,u,d=n.props,y=e.props,p=e.type,v=0;if(p==="svg"&&(s=!0),i!=null){for(;v<i.length;v++)if((c=i[v])&&(c===t||(p?c.localName==p:c.nodeType==3))){t=c,i[v]=null;break}}if(t==null){if(p===null)return document.createTextNode(y);t=s?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,y.is&&y),i=null,a=!1}if(p===null)d===y||a&&t.data===y||(t.data=y);else{if(i=i&&ft.call(t.childNodes),f=(d=n.props||ht).dangerouslySetInnerHTML,u=y.dangerouslySetInnerHTML,!a){if(i!=null)for(d={},v=0;v<t.attributes.length;v++)d[t.attributes[v].name]=t.attributes[v].value;(u||f)&&(u&&(f&&u.__html==f.__html||u.__html===t.innerHTML)||(t.innerHTML=u&&u.__html||""))}if(To(t,y,d,s,a),u)e.__k=[];else if(v=e.props.children,Ir(t,Array.isArray(v)?v:[v],e,n,r,s&&p!=="foreignObject",i,o,i?i[0]:n.__k&&Me(n,0),a),i!=null)for(v=i.length;v--;)i[v]!=null&&xr(i[v]);a||("value"in y&&(v=y.value)!==void 0&&(v!==t.value||p==="progress"&&!v)&&vt(t,"value",v,d.value,!1),"checked"in y&&(v=y.checked)!==void 0&&v!==t.checked&&vt(t,"checked",v,d.checked,!1))}return t}function Br(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){k.__e(r,n)}}function jr(t,e,n){var r,s;if(k.unmount&&k.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||Br(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){k.__e(i,e)}r.base=r.__P=null}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&jr(r[s],e,typeof t.type!="function");n||t.__e==null||xr(t.__e),t.__e=t.__d=void 0}function Ro(t,e,n){return this.constructor(t,n)}function Pl(t,e,n){var r,s,i;k.__&&k.__(t,e),s=(r=typeof n=="function")?null:n&&n.__k||e.__k,i=[],cn(e,t=(!r&&n||e).__k=No(pt,null,[t]),s||ht,ht,e.ownerSVGElement!==void 0,!r&&n?[n]:s?null:e.firstChild?ft.call(e.childNodes):null,i,!r&&n?n:s?s.__e:e.firstChild,r),Lr(i,t)}ft=kr.slice,k={__e:function(t,e){for(var n,r,s;e=e.__;)if((n=e.__c)&&!n.__)try{if((r=n.constructor)&&r.getDerivedStateFromError!=null&&(n.setState(r.getDerivedStateFromError(t)),s=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t),s=n.__d),s)return n.__E=n}catch(i){t=i}throw t}},Sr=0,yt.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ve({},this.state),typeof t=="function"&&(t=t(ve({},n),this.props)),t&&ve(n,t),t!=null&&this.__v&&(e&&this.__h.push(e),Mr(this))},yt.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Mr(this))},yt.prototype.render=pt,He=[],Or=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,mt.__r=0;var gt,Q,Ur,_t=0,un=[],Gr=k.__b,Fr=k.__r,qr=k.diffed,Hr=k.__c,Vr=k.unmount;function ln(t,e){k.__h&&k.__h(Q,t,_t||e),_t=0;var n=Q.__H||(Q.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function wl(t){return _t=1,$o(Jr,t)}function $o(t,e,n){var r=ln(gt++,2);return r.t=t,r.__c||(r.__=[n?n(e):Jr(void 0,e),function(s){var i=r.t(r.__[0],s);r.__[0]!==i&&(r.__=[i,r.__[1]],r.__c.setState({}))}],r.__c=Q),r.__}function Sl(t,e){var n=ln(gt++,3);!k.__s&&zr(n.__H,e)&&(n.__=t,n.__H=e,Q.__H.__h.push(n))}function Ol(t){return _t=5,Lo(function(){return{current:t}},[])}function Lo(t,e){var n=ln(gt++,7);return zr(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Bo(){un.forEach(function(t){if(t.__P)try{t.__H.__h.forEach(bt),t.__H.__h.forEach(fn),t.__H.__h=[]}catch(e){t.__H.__h=[],k.__e(e,t.__v)}}),un=[]}k.__b=function(t){Q=null,Gr&&Gr(t)},k.__r=function(t){Fr&&Fr(t),gt=0;var e=(Q=t.__c).__H;e&&(e.__h.forEach(bt),e.__h.forEach(fn),e.__h=[])},k.diffed=function(t){qr&&qr(t);var e=t.__c;e&&e.__H&&e.__H.__h.length&&(un.push(e)!==1&&Ur===k.requestAnimationFrame||((Ur=k.requestAnimationFrame)||function(n){var r,s=function(){clearTimeout(i),Wr&&cancelAnimationFrame(r),setTimeout(n)},i=setTimeout(s,100);Wr&&(r=requestAnimationFrame(s))})(Bo)),Q=null},k.__c=function(t,e){e.some(function(n){try{n.__h.forEach(bt),n.__h=n.__h.filter(function(r){return!r.__||fn(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],k.__e(r,n.__v)}}),Hr&&Hr(t,e)},k.unmount=function(t){Vr&&Vr(t);var e=t.__c;if(e&&e.__H)try{e.__H.__.forEach(bt)}catch(n){k.__e(n,e.__v)}};var Wr=typeof requestAnimationFrame=="function";function bt(t){var e=Q;typeof t.__c=="function"&&t.__c(),Q=e}function fn(t){var e=Q;t.__c=t.__(),Q=e}function zr(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function Jr(t,e){return typeof e=="function"?e(t):e}var jo=0;function Cl(t,e,n,r,s){var i,o,a={};for(o in e)o=="ref"?i=e[o]:a[o]=e[o];var c={type:t,props:a,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--jo,__source:r,__self:s};if(typeof t=="function"&&(i=t.defaultProps))for(o in i)a[o]===void 0&&(a[o]=i[o]);return k.vnode&&k.vnode(c),c}let Uo="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Go=(t=21)=>{let e="",n=t;for(;n--;)e+=Uo[Math.random()*64|0];return e};function X(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(s){return"'"+s+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ie(t){return!!t&&!!t[W]}function Se(t){return!!t&&(function(e){if(!e||typeof e!="object")return!1;var n=Object.getPrototypeOf(e);if(n===null)return!0;var r=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return r===Object||typeof r=="function"&&Function.toString.call(r)===Ko}(t)||Array.isArray(t)||!!t[ss]||!!t.constructor[ss]||dn(t)||pn(t))}function Ve(t,e,n){n===void 0&&(n=!1),Ne(t)===0?(n?Object.keys:Cn)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,s){return e(s,r,t)})}function Ne(t){var e=t[W];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:dn(t)?2:pn(t)?3:0}function hn(t,e){return Ne(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function Fo(t,e){return Ne(t)===2?t.get(e):t[e]}function Kr(t,e,n){var r=Ne(t);r===2?t.set(e,n):r===3?(t.delete(e),t.add(n)):t[e]=n}function qo(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function dn(t){return zo&&t instanceof Map}function pn(t){return Jo&&t instanceof Set}function Oe(t){return t.o||t.t}function yn(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=Yo(t);delete e[W];for(var n=Cn(e),r=0;r<n.length;r++){var s=n[r],i=e[s];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[s]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function mn(t,e){return e===void 0&&(e=!1),vn(t)||Ie(t)||!Se(t)||(Ne(t)>1&&(t.set=t.add=t.clear=t.delete=Ho),Object.freeze(t),e&&Ve(t,function(n,r){return mn(r,!0)},!0)),t}function Ho(){X(2)}function vn(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function se(t){var e=Qo[t];return e||X(18,t),e}function Yr(){return We}function gn(t,e){e&&(se("Patches"),t.u=[],t.s=[],t.v=e)}function Et(t){_n(t),t.p.forEach(Vo),t.p=null}function _n(t){t===We&&(We=t.l)}function Qr(t){return We={p:[],l:We,h:t,m:!0,_:0}}function Vo(t){var e=t[W];e.i===0||e.i===1?e.j():e.O=!0}function bn(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.g||se("ES5").S(e,t,r),r?(n[W].P&&(Et(e),X(4)),Se(t)&&(t=Pt(e,t),e.l||wt(e,t)),e.u&&se("Patches").M(n[W].t,t,e.u,e.s)):t=Pt(e,n,[]),Et(e),e.u&&e.v(e.u,e.s),t!==rs?t:void 0}function Pt(t,e,n){if(vn(e))return e;var r=e[W];if(!r)return Ve(e,function(i,o){return Xr(t,r,e,i,o,n)},!0),e;if(r.A!==t)return e;if(!r.P)return wt(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var s=r.i===4||r.i===5?r.o=yn(r.k):r.o;Ve(r.i===3?new Set(s):s,function(i,o){return Xr(t,r,s,i,o,n)}),wt(t,s,!1),n&&t.u&&se("Patches").R(r,n,t.u,t.s)}return r.o}function Xr(t,e,n,r,s,i){if(Ie(s)){var o=Pt(t,s,i&&e&&e.i!==3&&!hn(e.D,r)?i.concat(r):void 0);if(Kr(n,r,o),!Ie(o))return;t.m=!1}if(Se(s)&&!vn(s)){if(!t.h.F&&t._<1)return;Pt(t,s),e&&e.A.l||wt(t,s)}}function wt(t,e,n){n===void 0&&(n=!1),t.h.F&&t.m&&mn(e,n)}function En(t,e){var n=t[W];return(n?Oe(n):t)[e]}function Zr(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function Pn(t){t.P||(t.P=!0,t.l&&Pn(t.l))}function wn(t){t.o||(t.o=yn(t.t))}function Sn(t,e,n){var r=dn(e)?se("MapSet").N(e,n):pn(e)?se("MapSet").T(e,n):t.g?function(s,i){var o=Array.isArray(s),a={i:o?1:0,A:i?i.A:Yr(),P:!1,I:!1,D:{},l:i,t:s,k:null,o:null,j:null,C:!1},c=a,f=kn;o&&(c=[a],f=ze);var u=Proxy.revocable(c,f),d=u.revoke,y=u.proxy;return a.k=y,a.j=d,y}(e,n):se("ES5").J(e,n);return(n?n.A:Yr()).p.push(r),r}function Wo(t){return Ie(t)||X(22,t),function e(n){if(!Se(n))return n;var r,s=n[W],i=Ne(n);if(s){if(!s.P&&(s.i<4||!se("ES5").K(s)))return s.t;s.I=!0,r=es(n,i),s.I=!1}else r=es(n,i);return Ve(r,function(o,a){s&&Fo(s.t,o)===a||Kr(r,o,e(a))}),i===3?new Set(r):r}(t)}function es(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return yn(t)}var ts,We,On=typeof Symbol!="undefined"&&typeof Symbol("x")=="symbol",zo=typeof Map!="undefined",Jo=typeof Set!="undefined",ns=typeof Proxy!="undefined"&&Proxy.revocable!==void 0&&typeof Reflect!="undefined",rs=On?Symbol.for("immer-nothing"):((ts={})["immer-nothing"]=!0,ts),ss=On?Symbol.for("immer-draftable"):"__$immer_draftable",W=On?Symbol.for("immer-state"):"__$immer_state",Ko=""+Object.prototype.constructor,Cn=typeof Reflect!="undefined"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,Yo=Object.getOwnPropertyDescriptors||function(t){var e={};return Cn(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},Qo={},kn={get:function(t,e){if(e===W)return t;var n=Oe(t);if(!hn(n,e))return function(s,i,o){var a,c=Zr(i,o);return c?"value"in c?c.value:(a=c.get)===null||a===void 0?void 0:a.call(s.k):void 0}(t,n,e);var r=n[e];return t.I||!Se(r)?r:r===En(t.t,e)?(wn(t),t.o[e]=Sn(t.A.h,r,t)):r},has:function(t,e){return e in Oe(t)},ownKeys:function(t){return Reflect.ownKeys(Oe(t))},set:function(t,e,n){var r=Zr(Oe(t),e);if(r==null?void 0:r.set)return r.set.call(t.k,n),!0;if(!t.P){var s=En(Oe(t),e),i=s==null?void 0:s[W];if(i&&i.t===n)return t.o[e]=n,t.D[e]=!1,!0;if(qo(n,s)&&(n!==void 0||hn(t.t,e)))return!0;wn(t),Pn(t)}return t.o[e]===n&&typeof n!="number"&&(n!==void 0||e in t.o)||(t.o[e]=n,t.D[e]=!0,!0)},deleteProperty:function(t,e){return En(t.t,e)!==void 0||e in t.t?(t.D[e]=!1,wn(t),Pn(t)):delete t.D[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=Oe(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){X(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){X(12)}},ze={};Ve(kn,function(t,e){ze[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),ze.deleteProperty=function(t,e){return ze.set.call(this,t,e,void 0)},ze.set=function(t,e,n){return kn.set.call(this,t[0],e,n,t[0])};var Xo=function(){function t(n){var r=this;this.g=ns,this.F=!0,this.produce=function(s,i,o){if(typeof s=="function"&&typeof i!="function"){var a=i;i=s;var c=r;return function(E){var _=this;E===void 0&&(E=a);for(var P=arguments.length,g=Array(P>1?P-1:0),C=1;C<P;C++)g[C-1]=arguments[C];return c.produce(E,function(w){var V;return(V=i).call.apply(V,[_,w].concat(g))})}}var f;if(typeof i!="function"&&X(6),o!==void 0&&typeof o!="function"&&X(7),Se(s)){var u=Qr(r),d=Sn(r,s,void 0),y=!0;try{f=i(d),y=!1}finally{y?Et(u):_n(u)}return typeof Promise!="undefined"&&f instanceof Promise?f.then(function(E){return gn(u,o),bn(E,u)},function(E){throw Et(u),E}):(gn(u,o),bn(f,u))}if(!s||typeof s!="object"){if((f=i(s))===void 0&&(f=s),f===rs&&(f=void 0),r.F&&mn(f,!0),o){var p=[],v=[];se("Patches").M(s,f,p,v),o(p,v)}return f}X(21,s)},this.produceWithPatches=function(s,i){if(typeof s=="function")return function(f){for(var u=arguments.length,d=Array(u>1?u-1:0),y=1;y<u;y++)d[y-1]=arguments[y];return r.produceWithPatches(f,function(p){return s.apply(void 0,[p].concat(d))})};var o,a,c=r.produce(s,i,function(f,u){o=f,a=u});return typeof Promise!="undefined"&&c instanceof Promise?c.then(function(f){return[f,o,a]}):[c,o,a]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){Se(n)||X(8),Ie(n)&&(n=Wo(n));var r=Qr(this),s=Sn(this,n,void 0);return s[W].C=!0,_n(r),s},e.finishDraft=function(n,r){var s=n&&n[W],i=s.A;return gn(i,r),bn(void 0,i)},e.setAutoFreeze=function(n){this.F=n},e.setUseProxies=function(n){n&&!ns&&X(20),this.g=n},e.applyPatches=function(n,r){var s;for(s=r.length-1;s>=0;s--){var i=r[s];if(i.path.length===0&&i.op==="replace"){n=i.value;break}}s>-1&&(r=r.slice(s+1));var o=se("Patches").$;return Ie(n)?o(n,r):this.produce(n,function(a){return o(a,r)})},t}(),z=new Xo,Zo=z.produce;z.produceWithPatches.bind(z);z.setAutoFreeze.bind(z);z.setUseProxies.bind(z);z.applyPatches.bind(z);z.createDraft.bind(z);z.finishDraft.bind(z);var ea=Zo;class ta{constructor(e){const n=na();this.c=1,this.s0=n(" "),this.s1=n(" "),this.s2=n(" "),this.s0-=n(e),this.s0<0&&(this.s0+=1),this.s1-=n(e),this.s1<0&&(this.s1+=1),this.s2-=n(e),this.s2<0&&(this.s2+=1)}next(){const e=2091639*this.s0+this.c*23283064365386963e-26;return this.s0=this.s1,this.s1=this.s2,this.s2=e-(this.c=Math.trunc(e))}}function na(){let t=4022871197;return function(n){const r=n.toString();for(let s=0;s<r.length;s++){t+=r.charCodeAt(s);let i=.02519603282416938*t;t=i>>>0,i-=t,i*=t,t=i>>>0,i-=t,t+=i*4294967296}return(t>>>0)*23283064365386963e-26}}function is(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function os(t,e){const n=new ta(t),r=n.next.bind(n);return e&&is(e,n),r.state=()=>is(n,{}),r}class as{constructor(e){this.state=e||{seed:"0"},this.used=!1}static seed(){return Date.now().toString(36).slice(-10)}isUsed(){return this.used}getState(){return this.state}_random(){this.used=!0;const e=this.state,n=e.prngstate?"":e.seed,r=os(n,e.prngstate),s=r();return this.state={...e,prngstate:r.state()},s}api(){const e=this._random.bind(this),n={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},r={};for(const i in n){const o=n[i];r[i]=a=>a===void 0?Math.floor(e()*o)+1:Array.from({length:a}).map(()=>Math.floor(e()*o)+1)}function s(i=6,o){return o===void 0?Math.floor(e()*i)+1:Array.from({length:o}).map(()=>Math.floor(e()*i)+1)}return{...r,Die:s,Number:()=>e(),Shuffle:i=>{const o=[...i];let a=i.length,c=0;const f=Array.from({length:a});for(;a;){const u=Math.trunc(a*e());f[c++]=o[u],o[u]=o[--a]}return f},_private:this}}}const ra={name:"random",noClient:({api:t})=>t._private.isUsed(),flush:({api:t})=>t._private.getState(),api:({data:t})=>new as(t).api(),setup:({game:t})=>{let{seed:e}=t;return e===void 0&&(e=as.seed()),{seed:e}},playerView:()=>{}};var L=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},sa=Function.prototype,ia=sa.toString;ia.call(Object);const Je="MAKE_MOVE",St="GAME_EVENT",Ot="REDO",xn="RESET",An="SYNC",Ct="UNDO",Mn="UPDATE",In="PATCH",cs="PLUGIN",kt="STRIP_TRANSIENTS",us=(t,e,n,r)=>({type:Je,payload:{type:t,args:e,playerID:n,credentials:r}}),Ke=(t,e,n,r)=>({type:St,payload:{type:t,args:e,playerID:n,credentials:r}}),ls=(t,e,n,r)=>({type:St,payload:{type:t,args:e,playerID:n,credentials:r},automatic:!0}),fs=t=>({type:An,state:t.state,log:t.log,initialState:t.initialState,clientOnly:!0}),hs=(t,e,n,r)=>({type:In,prevStateID:t,stateID:e,patch:n,deltalog:r,clientOnly:!0}),ds=(t,e)=>({type:Mn,state:t,deltalog:e,clientOnly:!0}),ps=t=>({type:xn,state:t,clientOnly:!0}),ys=(t,e)=>({type:Ct,payload:{type:null,args:null,playerID:t,credentials:e}}),ms=(t,e)=>({type:Ot,payload:{type:null,args:null,playerID:t,credentials:e}}),oa=(t,e,n,r)=>({type:cs,payload:{type:t,args:e,playerID:n,credentials:r}}),vs=()=>({type:kt});var aa=Object.freeze({__proto__:null,makeMove:us,gameEvent:Ke,automaticGameEvent:ls,sync:fs,patch:hs,update:ds,reset:ps,undo:ys,redo:ms,plugin:oa,stripTransients:vs});const Nn="INVALID_MOVE",ca={name:"plugin-immer",fnWrap:t=>(e,n,...r)=>{let s=!1;const i=ea(e,o=>{const a=t(o,n,...r);if(a===Nn){s=!0;return}return a});return s?Nn:i}};var B;(function(t){t.MOVE="MOVE",t.GAME_ON_END="GAME_ON_END",t.PHASE_ON_BEGIN="PHASE_ON_BEGIN",t.PHASE_ON_END="PHASE_ON_END",t.TURN_ON_BEGIN="TURN_ON_BEGIN",t.TURN_ON_MOVE="TURN_ON_MOVE",t.TURN_ON_END="TURN_ON_END"})(B||(B={}));var le;(function(t){t.CalledOutsideHook="Events must be called from moves or the `onBegin`, `onEnd`, and `onMove` hooks.\nThis error probably means you called an event from other game code, like an `endIf` trigger or one of the `turn.order` methods.",t.EndTurnInOnEnd="`endTurn` is disallowed in `onEnd` hooks \u2014 the turn is already ending.",t.MaxTurnEndings=`Maximum number of turn endings exceeded for this update.
This likely means game code is triggering an infinite loop.`,t.PhaseEventInOnEnd="`setPhase` & `endPhase` are disallowed in a phase\u2019s `onEnd` hook \u2014 the phase is already ending.\nIf you\u2019re trying to dynamically choose the next phase when a phase ends, use the phase\u2019s `next` trigger.",t.StageEventInOnEnd="`setStage`, `endStage` & `setActivePlayers` are disallowed in `onEnd` hooks.",t.StageEventInPhaseBegin="`setStage`, `endStage` & `setActivePlayers` are disallowed in a phase\u2019s `onBegin` hook.\nUse `setActivePlayers` in a `turn.onBegin` hook or declare stages with `turn.activePlayers` instead.",t.StageEventInTurnBegin="`setStage` & `endStage` are disallowed in `turn.onBegin`.\nUse `setActivePlayers` or declare stages with `turn.activePlayers` instead."})(le||(le={}));class ua{constructor(e,n,r){this.flow=e,this.playerID=r,this.dispatch=[],this.initialTurn=n.turn,this.updateTurnContext(n,void 0),this.maxEndedTurnsPerAction=n.numPlayers*100}api(){const e={_private:this};for(const n of this.flow.eventNames)e[n]=(...r)=>{this.dispatch.push({type:n,args:r,phase:this.currentPhase,turn:this.currentTurn,calledFrom:this.currentMethod,error:new Error("Events Plugin Error")})};return e}isUsed(){return this.dispatch.length>0}updateTurnContext(e,n){this.currentPhase=e.phase,this.currentTurn=e.turn,this.currentMethod=n}unsetCurrentMethod(){this.currentMethod=void 0}update(e){const n=e,r=({stack:s},i)=>({...n,plugins:{...n.plugins,events:{...n.plugins.events,data:{error:i+`
`+s}}}});e:for(let s=0;s<this.dispatch.length;s++){const i=this.dispatch[s],o=i.turn!==e.ctx.turn;if(this.currentTurn-this.initialTurn>=this.maxEndedTurnsPerAction)return r(i.error,le.MaxTurnEndings);if(i.calledFrom===void 0)return r(i.error,le.CalledOutsideHook);if(e.ctx.gameover)break e;switch(i.type){case"endStage":case"setStage":case"setActivePlayers":{switch(i.calledFrom){case B.TURN_ON_END:case B.PHASE_ON_END:return r(i.error,le.StageEventInOnEnd);case B.PHASE_ON_BEGIN:return r(i.error,le.StageEventInPhaseBegin);case B.TURN_ON_BEGIN:if(i.type==="setActivePlayers")break;return r(i.error,le.StageEventInTurnBegin)}if(o)continue e;break}case"endTurn":{if(i.calledFrom===B.TURN_ON_END||i.calledFrom===B.PHASE_ON_END)return r(i.error,le.EndTurnInOnEnd);if(o)continue e;break}case"endPhase":case"setPhase":{if(i.calledFrom===B.PHASE_ON_END)return r(i.error,le.PhaseEventInOnEnd);if(i.phase!==e.ctx.phase)continue e;break}}const c=ls(i.type,i.args,this.playerID);e=this.flow.processEvent(e,c)}return e}}const Tn={name:"events",noClient:({api:t})=>t._private.isUsed(),isInvalid:({data:t})=>t.error||!1,fnWrap:(t,e)=>(n,r,...s)=>{const i=r.events;return i&&i._private.updateTurnContext(r,e),n=t(n,r,...s),i&&i._private.unsetCurrentMethod(),n},dangerouslyFlushRawState:({state:t,api:e})=>e._private.update(t),api:({game:t,ctx:e,playerID:n})=>new ua(t.flow,e,n).api()},la={name:"log",flush:()=>({}),api:({data:t})=>({setMetadata:e=>{t.metadata=e}}),setup:()=>({})},fa={name:"plugin-serializable",fnWrap:t=>(e,n,...r)=>t(e,n,...r)},ha=(...t)=>console.error(...t);function gs(t){}function I(t){ha("ERROR:",t)}const Dn=[ca,ra,la,fa],Ye=[...Dn,Tn],da=(t,e,n)=>(n.game.plugins.filter(r=>r.action!==void 0).filter(r=>r.name===e.payload.type).forEach(r=>{const s=r.name,i=t.plugins[s]||{data:{}},o=r.action(i.data,e.payload);t={...t,plugins:{...t.plugins,[s]:{...i,data:o}}}}),t),Te=t=>{const e={...t.ctx},n=t.plugins||{};return Object.entries(n).forEach(([r,{api:s}])=>{e[r]=s}),e},_s=(t,e,n)=>[...Dn,...n,Tn].filter(r=>r.fnWrap!==void 0).reduce((r,{fnWrap:s})=>s(r,e),t),pa=(t,e)=>([...Ye,...e.game.plugins].filter(n=>n.setup!==void 0).forEach(n=>{const r=n.name,s=n.setup({G:t.G,ctx:t.ctx,game:e.game});t={...t,plugins:{...t.plugins,[r]:{data:s}}}}),t),Rn=(t,e)=>([...Ye,...e.game.plugins].filter(n=>n.api!==void 0).forEach(n=>{const r=n.name,s=t.plugins[r]||{data:{}},i=n.api({G:t.G,ctx:t.ctx,data:s.data,game:e.game,playerID:e.playerID});t={...t,plugins:{...t.plugins,[r]:{...s,api:i}}}}),t),ya=(t,e)=>([...Dn,...e.game.plugins,Tn].reverse().forEach(n=>{const r=n.name,s=t.plugins[r]||{data:{}};if(n.flush){const i=n.flush({G:t.G,ctx:t.ctx,game:e.game,api:s.api,data:s.data});t={...t,plugins:{...t.plugins,[n.name]:{data:i}}}}else if(n.dangerouslyFlushRawState){t=n.dangerouslyFlushRawState({state:t,game:e.game,api:s.api,data:s.data});const i=t.plugins[r].data;t={...t,plugins:{...t.plugins,[n.name]:{data:i}}}}}),t),ma=(t,e)=>[...Ye,...e.game.plugins].filter(n=>n.noClient!==void 0).map(n=>{const r=n.name,s=t.plugins[r];return s?n.noClient({G:t.G,ctx:t.ctx,game:e.game,api:s.api,data:s.data}):!1}).includes(!0),va=(t,e)=>[...Ye,...e.game.plugins].filter(r=>r.isInvalid!==void 0).map(r=>{const{name:s}=r,i=t.plugins[s],o=r.isInvalid({G:t.G,ctx:t.ctx,game:e.game,data:i&&i.data});return o?{plugin:s,message:o}:!1}).find(r=>r)||!1,bs=(t,e)=>{const n=ya(t,e),r=va(n,e);if(!r)return[n];const{plugin:s,message:i}=r;return I(`${s} plugin declared action invalid:
${i}`),[t,r]},Es=({G:t,ctx:e,plugins:n={}},{game:r,playerID:s})=>([...Ye,...r.plugins].forEach(({name:i,playerView:o})=>{if(!o)return;const{data:a}=n[i]||{data:{}},c=o({G:t,ctx:e,game:r,data:a,playerID:s});n={...n,[i]:{data:c}}}),n);function xt(t,e=!1){t.moveLimit&&(e&&(t.minMoves=t.moveLimit),t.maxMoves=t.moveLimit,delete t.moveLimit)}function At(t,e){let n={},r=[],s=null,i={},o={};if(Array.isArray(e)){const c={};e.forEach(f=>c[f]=It.NULL),n=c}else{if(xt(e),e.next&&(s=e.next),e.revert&&(r=[...t._prevActivePlayers,{activePlayers:t.activePlayers,_activePlayersMinMoves:t._activePlayersMinMoves,_activePlayersMaxMoves:t._activePlayersMaxMoves,_activePlayersNumMoves:t._activePlayersNumMoves}]),e.currentPlayer!==void 0&&Mt(n,i,o,t.currentPlayer,e.currentPlayer),e.others!==void 0)for(let c=0;c<t.playOrder.length;c++){const f=t.playOrder[c];f!==t.currentPlayer&&Mt(n,i,o,f,e.others)}if(e.all!==void 0)for(let c=0;c<t.playOrder.length;c++){const f=t.playOrder[c];Mt(n,i,o,f,e.all)}if(e.value)for(const c in e.value)Mt(n,i,o,c,e.value[c]);if(e.minMoves)for(const c in n)i[c]===void 0&&(i[c]=e.minMoves);if(e.maxMoves)for(const c in n)o[c]===void 0&&(o[c]=e.maxMoves)}Object.keys(n).length===0&&(n=null),Object.keys(i).length===0&&(i=null),Object.keys(o).length===0&&(o=null);const a={};for(const c in n)a[c]=0;return{...t,activePlayers:n,_activePlayersMinMoves:i,_activePlayersMaxMoves:o,_activePlayersNumMoves:a,_prevActivePlayers:r,_nextActivePlayers:s}}function ga(t){let{activePlayers:e,_activePlayersMinMoves:n,_activePlayersMaxMoves:r,_activePlayersNumMoves:s,_prevActivePlayers:i,_nextActivePlayers:o}=t;if(e&&Object.keys(e).length===0)if(o)t=At(t,o),{activePlayers:e,_activePlayersMinMoves:n,_activePlayersMaxMoves:r,_activePlayersNumMoves:s,_prevActivePlayers:i}=t;else if(i.length>0){const a=i.length-1;({activePlayers:e,_activePlayersMinMoves:n,_activePlayersMaxMoves:r,_activePlayersNumMoves:s}=i[a]),i=i.slice(0,a)}else e=null,n=null,r=null;return{...t,activePlayers:e,_activePlayersMinMoves:n,_activePlayersMaxMoves:r,_activePlayersNumMoves:s,_prevActivePlayers:i}}function Mt(t,e,n,r,s){(typeof s!="object"||s===It.NULL)&&(s={stage:s}),s.stage!==void 0&&(xt(s),t[r]=s.stage,s.minMoves&&(e[r]=s.minMoves),s.maxMoves&&(n[r]=s.maxMoves))}function $n(t,e){return t[e]+""}function _a(t,e){let{G:n,ctx:r}=t;const{numPlayers:s}=r,i=Te(t),o=e.order;let a=[...Array.from({length:s})].map((d,y)=>y+"");o.playOrder!==void 0&&(a=o.playOrder(n,i));const c=o.first(n,i),f=typeof c;f!=="number"&&I(`invalid value returned by turn.order.first \u2014 expected number got ${f} \u201C${c}\u201D.`);const u=$n(a,c);return r={...r,currentPlayer:u,playOrderPos:c,playOrder:a},r=At(r,e.activePlayers||{}),r}function ba(t,e,n,r){const s=n.order;let{G:i,ctx:o}=t,a=o.playOrderPos,c=!1;if(r&&r!==!0)typeof r!="object"&&I(`invalid argument to endTurn: ${r}`),Object.keys(r).forEach(f=>{switch(f){case"remove":e=$n(o.playOrder,a);break;case"next":a=o.playOrder.indexOf(r.next),e=r.next;break;default:I(`invalid argument to endTurn: ${f}`)}});else{const f=Te(t),u=s.next(i,f),d=typeof u;u!==void 0&&d!=="number"&&I(`invalid value returned by turn.order.next \u2014 expected number or undefined got ${d} \u201C${u}\u201D.`),u===void 0?c=!0:(a=u,e=$n(o.playOrder,a))}return o={...o,playOrderPos:a,currentPlayer:e},{endPhase:c,ctx:o}}const Ea={DEFAULT:{first:(t,e)=>e.turn===0?e.playOrderPos:(e.playOrderPos+1)%e.playOrder.length,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length},RESET:{first:()=>0,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length},CONTINUE:{first:(t,e)=>e.playOrderPos,next:(t,e)=>(e.playOrderPos+1)%e.playOrder.length},ONCE:{first:()=>0,next:(t,e)=>{if(e.playOrderPos<e.playOrder.length-1)return e.playOrderPos+1}},CUSTOM:t=>({playOrder:()=>t,first:()=>0,next:(e,n)=>(n.playOrderPos+1)%n.playOrder.length}),CUSTOM_FROM:t=>({playOrder:e=>e[t],first:()=>0,next:(e,n)=>(n.playOrderPos+1)%n.playOrder.length})},It={NULL:null};var Ce={},De={};Object.defineProperty(De,"__esModule",{value:!0});De.Pointer=void 0;function Pa(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function wa(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}var Sa=function(){function t(e){e===void 0&&(e=[""]),this.tokens=e}return t.fromJSON=function(e){var n=e.split("/").map(Pa);if(n[0]!=="")throw new Error("Invalid JSON Pointer: "+e);return new t(n)},t.prototype.toString=function(){return this.tokens.map(wa).join("/")},t.prototype.evaluate=function(e){for(var n=null,r="",s=e,i=1,o=this.tokens.length;i<o;i++)n=s,r=this.tokens[i],!(r=="__proto__"||r=="constructor"||r=="prototype")&&(s=(n||{})[r]);return{parent:n,key:r,value:s}},t.prototype.get=function(e){return this.evaluate(e).value},t.prototype.set=function(e,n){for(var r=e,s=1,i=this.tokens.length-1,o=this.tokens[s];s<i;s++)r=(r||{})[o];r&&(r[this.tokens[this.tokens.length-1]]=n)},t.prototype.push=function(e){this.tokens.push(e)},t.prototype.add=function(e){var n=this.tokens.concat(String(e));return new t(n)},t}();De.Pointer=Sa;var D={},Ln={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.clone=t.objectType=t.hasOwnProperty=void 0,t.hasOwnProperty=Object.prototype.hasOwnProperty;function e(s){return s===void 0?"undefined":s===null?"null":Array.isArray(s)?"array":typeof s}t.objectType=e;function n(s){return s!=null&&typeof s=="object"}function r(s){if(!n(s))return s;if(s.constructor==Array){for(var i=s.length,o=new Array(i),a=0;a<i;a++)o[a]=r(s[a]);return o}if(s.constructor==Date){var c=new Date(+s);return c}var f={};for(var u in s)t.hasOwnProperty.call(s,u)&&(f[u]=r(s[u]));return f}t.clone=r})(Ln);var G={};Object.defineProperty(G,"__esModule",{value:!0});G.diffAny=G.diffObjects=G.diffArrays=G.intersection=G.subtract=G.isDestructive=void 0;var Oa=De,Qe=Ln;function Ca(t){var e=t.op;return e==="remove"||e==="replace"||e==="copy"||e==="move"}G.isDestructive=Ca;function Bn(t,e){var n={};for(var r in t)Qe.hasOwnProperty.call(t,r)&&t[r]!==void 0&&(n[r]=1);for(var s in e)Qe.hasOwnProperty.call(e,s)&&e[s]!==void 0&&delete n[s];return Object.keys(n)}G.subtract=Bn;function Ps(t){for(var e=t.length,n={},r=0;r<e;r++){var s=t[r];for(var i in s)Qe.hasOwnProperty.call(s,i)&&s[i]!==void 0&&(n[i]=(n[i]||0)+1)}for(var i in n)n[i]<e&&delete n[i];return Object.keys(n)}G.intersection=Ps;function ka(t){return t.op==="add"}function xa(t){return t.op==="remove"}function jn(t,e){return{operations:t.operations.concat(e),cost:t.cost+1}}function ws(t,e,n,r){r===void 0&&(r=Nt);var s={"0,0":{operations:[],cost:0}};function i(u,d){var y=u+","+d,p=s[y];if(p===void 0){if(u>0&&d>0&&!r(t[u-1],e[d-1],new Oa.Pointer).length)p=i(u-1,d-1);else{var v=[];if(u>0){var E=i(u-1,d),_={op:"remove",index:u-1};v.push(jn(E,_))}if(d>0){var P=i(u,d-1),g={op:"add",index:u-1,value:e[d-1]};v.push(jn(P,g))}if(u>0&&d>0){var C=i(u-1,d-1),w={op:"replace",index:u-1,original:t[u-1],value:e[d-1]};v.push(jn(C,w))}var V=v.sort(function(at,ct){return at.cost-ct.cost})[0];p=V}s[y]=p}return p}var o=isNaN(t.length)||t.length<=0?0:t.length,a=isNaN(e.length)||e.length<=0?0:e.length,c=i(o,a).operations,f=c.reduce(function(u,d){var y=u[0],p=u[1];if(ka(d)){var v=d.index+1+p,E=v<o+p?String(v):"-",_={op:d.op,path:n.add(E).toString(),value:d.value};return[y.concat(_),p+1]}else if(xa(d)){var _={op:d.op,path:n.add(String(d.index+p)).toString()};return[y.concat(_),p-1]}else{var P=n.add(String(d.index+p)),g=r(d.original,d.value,P);return[y.concat.apply(y,g),p]}},[[],0])[0];return f}G.diffArrays=ws;function Ss(t,e,n,r){r===void 0&&(r=Nt);var s=[];return Bn(t,e).forEach(function(i){s.push({op:"remove",path:n.add(i).toString()})}),Bn(e,t).forEach(function(i){s.push({op:"add",path:n.add(i).toString(),value:e[i]})}),Ps([t,e]).forEach(function(i){s.push.apply(s,r(t[i],e[i],n.add(i)))}),s}G.diffObjects=Ss;function Nt(t,e,n,r){if(r===void 0&&(r=Nt),t===e)return[];var s=Qe.objectType(t),i=Qe.objectType(e);return s=="array"&&i=="array"?ws(t,e,n,r):s=="object"&&i=="object"?Ss(t,e,n,r):[{op:"replace",path:n.toString(),value:e}]}G.diffAny=Nt;var Un=L&&L.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(D,"__esModule",{value:!0});D.apply=D.InvalidOperationError=D.test=D.copy=D.move=D.replace=D.remove=D.add=D.TestError=D.MissingError=void 0;var fe=De,Os=Ln,Aa=G,ie=function(t){Un(e,t);function e(n){var r=t.call(this,"Value required at path: "+n)||this;return r.path=n,r.name="MissingError",r}return e}(Error);D.MissingError=ie;var Cs=function(t){Un(e,t);function e(n,r){var s=t.call(this,"Test failed: "+n+" != "+r)||this;return s.actual=n,s.expected=r,s.name="TestError",s}return e}(Error);D.TestError=Cs;function Gn(t,e,n){if(Array.isArray(t))if(e=="-")t.push(n);else{var r=parseInt(e,10);t.splice(r,0,n)}else t[e]=n}function ks(t,e){if(Array.isArray(t)){var n=parseInt(e,10);t.splice(n,1)}else delete t[e]}function xs(t,e){var n=fe.Pointer.fromJSON(e.path).evaluate(t);return n.parent===void 0?new ie(e.path):(Gn(n.parent,n.key,Os.clone(e.value)),null)}D.add=xs;function As(t,e){var n=fe.Pointer.fromJSON(e.path).evaluate(t);return n.value===void 0?new ie(e.path):(ks(n.parent,n.key),null)}D.remove=As;function Ms(t,e){var n=fe.Pointer.fromJSON(e.path).evaluate(t);if(n.parent===null)return new ie(e.path);if(Array.isArray(n.parent)){if(parseInt(n.key,10)>=n.parent.length)return new ie(e.path)}else if(n.value===void 0)return new ie(e.path);return n.parent[n.key]=e.value,null}D.replace=Ms;function Is(t,e){var n=fe.Pointer.fromJSON(e.from).evaluate(t);if(n.value===void 0)return new ie(e.from);var r=fe.Pointer.fromJSON(e.path).evaluate(t);return r.parent===void 0?new ie(e.path):(ks(n.parent,n.key),Gn(r.parent,r.key,n.value),null)}D.move=Is;function Ns(t,e){var n=fe.Pointer.fromJSON(e.from).evaluate(t);if(n.value===void 0)return new ie(e.from);var r=fe.Pointer.fromJSON(e.path).evaluate(t);return r.parent===void 0?new ie(e.path):(Gn(r.parent,r.key,Os.clone(n.value)),null)}D.copy=Ns;function Ts(t,e){var n=fe.Pointer.fromJSON(e.path).evaluate(t);return Aa.diffAny(n.value,e.value,new fe.Pointer).length?new Cs(n.value,e.value):null}D.test=Ts;var Ds=function(t){Un(e,t);function e(n){var r=t.call(this,"Invalid operation: "+n.op)||this;return r.operation=n,r.name="InvalidOperationError",r}return e}(Error);D.InvalidOperationError=Ds;function Ma(t,e){switch(e.op){case"add":return xs(t,e);case"remove":return As(t,e);case"replace":return Ms(t,e);case"move":return Is(t,e);case"copy":return Ns(t,e);case"test":return Ts(t,e)}return new Ds(e)}D.apply=Ma;Object.defineProperty(Ce,"__esModule",{value:!0});Ce.createTests=Ls=Ce.createPatch=$s=Ce.applyPatch=void 0;var Rs=De,Ia=D,Fn=G;function Na(t,e){return e.map(function(n){return Ia.apply(t,n)})}var $s=Ce.applyPatch=Na;function Ta(t){function e(n,r,s){var i=t(n,r,s);return Array.isArray(i)?i:Fn.diffAny(n,r,s,e)}return e}function Da(t,e,n){var r=new Rs.Pointer;return(n?Ta(n):Fn.diffAny)(t,e,r)}var Ls=Ce.createPatch=Da;function Bs(t,e){var n=Rs.Pointer.fromJSON(e).evaluate(t);if(n!==void 0)return{op:"test",path:e,value:n.value}}function Ra(t,e){var n=new Array;return e.filter(Fn.isDestructive).forEach(function(r){var s=Bs(t,r.path);if(s&&n.push(s),"from"in r){var i=Bs(t,r.from);i&&n.push(i)}}),n}Ce.createTests=Ra;function $a({moves:t,phases:e,endIf:n,onEnd:r,turn:s,events:i,plugins:o}){t===void 0&&(t={}),i===void 0&&(i={}),o===void 0&&(o=[]),e===void 0&&(e={}),n||(n=()=>{}),r||(r=l=>l),s||(s={});const a={...e};""in a&&I("cannot specify phase with empty name"),a[""]={};const c={},f=new Set;let u=null;Object.keys(t).forEach(l=>f.add(l));const d=(l,h)=>{const m=_s(l,h,o);return x=>{const O=Te(x);return m(x.G,O)}},y=l=>h=>{const m=Te(h);return l(h.G,m)},p={onEnd:d(r,B.GAME_ON_END),endIf:y(n)};for(const l in a){const h=a[l];if(h.start===!0&&(u=l),h.moves!==void 0)for(const m of Object.keys(h.moves))c[l+"."+m]=h.moves[m],f.add(m);h.endIf===void 0&&(h.endIf=()=>{}),h.onBegin===void 0&&(h.onBegin=m=>m),h.onEnd===void 0&&(h.onEnd=m=>m),h.turn===void 0&&(h.turn=s),h.turn.order===void 0&&(h.turn.order=Ea.DEFAULT),h.turn.onBegin===void 0&&(h.turn.onBegin=m=>m),h.turn.onEnd===void 0&&(h.turn.onEnd=m=>m),h.turn.endIf===void 0&&(h.turn.endIf=()=>!1),h.turn.onMove===void 0&&(h.turn.onMove=m=>m),h.turn.stages===void 0&&(h.turn.stages={}),xt(h.turn,!0);for(const m in h.turn.stages){const O=h.turn.stages[m].moves||{};for(const S of Object.keys(O)){const T=l+"."+m+"."+S;c[T]=O[S],f.add(S)}}if(h.wrapped={onBegin:d(h.onBegin,B.PHASE_ON_BEGIN),onEnd:d(h.onEnd,B.PHASE_ON_END),endIf:y(h.endIf)},h.turn.wrapped={onMove:d(h.turn.onMove,B.TURN_ON_MOVE),onBegin:d(h.turn.onBegin,B.TURN_ON_BEGIN),onEnd:d(h.turn.onEnd,B.TURN_ON_END),endIf:y(h.turn.endIf)},typeof h.next!="function"){const{next:m}=h;h.next=()=>m||null}h.wrapped.next=y(h.next)}function v(l){return l.phase?a[l.phase]:a[""]}function E(l){return l}function _(l,h){const m=new Set,x=new Set;for(let O=0;O<h.length;O++){const{fn:S,arg:T,...N}=h[O];if(S===Ee){x.clear();const U=l.ctx.phase;if(m.has(U)){const re={...l.ctx,phase:null};return{...l,ctx:re}}m.add(U)}const Y=[];if(l=S(l,{...N,arg:T,next:Y}),S===rn)break;const R=yo(l);if(R){h.push({fn:rn,arg:R,turn:l.ctx.turn,phase:l.ctx.phase,automatic:!0});continue}const $=mo(l);if($){h.push({fn:Ee,arg:$,turn:l.ctx.turn,phase:l.ctx.phase,automatic:!0});continue}if([E,at,ct].includes(S)){const U=vo(l);if(U){h.push({fn:ut,arg:U,turn:l.ctx.turn,phase:l.ctx.phase,automatic:!0});continue}}h.push(...Y)}return l}function P(l,{next:h}){return h.push({fn:g}),l}function g(l,{next:h}){let{G:m,ctx:x}=l;return m=v(x).wrapped.onBegin(l),h.push({fn:C}),{...l,G:m,ctx:x}}function C(l,{currentPlayer:h}){let{ctx:m}=l;const x=v(m);h?(m={...m,currentPlayer:h},x.turn.activePlayers&&(m=At(m,x.turn.activePlayers))):m=_a(l,x.turn);const O=m.turn+1;m={...m,turn:O,numMoves:0,_prevActivePlayers:[]};const S=x.turn.wrapped.onBegin({...l,ctx:m});return{...l,G:S,ctx:m,_undo:[],_redo:[]}}function w(l,{arg:h,next:m,phase:x}){const O=v({phase:x});let{ctx:S}=l;if(h&&h.next)if(h.next in a)S={...S,phase:h.next};else return I("invalid phase: "+h.next),l;else S={...S,phase:O.wrapped.next(l)||null};return l={...l,ctx:S},m.push({fn:g}),l}function V(l,{arg:h,currentPlayer:m,next:x}){let{G:O,ctx:S}=l;const T=v(S),{endPhase:N,ctx:Y}=ba(l,m,T.turn,h);return S=Y,l={...l,G:O,ctx:S},N?x.push({fn:Ee,turn:S.turn,phase:S.phase}):x.push({fn:C,currentPlayer:S.currentPlayer}),l}function at(l,{arg:h,playerID:m}){if((typeof h=="string"||h===It.NULL)&&(h={stage:h}),typeof h!="object")return l;xt(h);let{ctx:x}=l,{activePlayers:O,_activePlayersMinMoves:S,_activePlayersMaxMoves:T,_activePlayersNumMoves:N}=x;return h.stage!==void 0&&(O===null&&(O={}),O[m]=h.stage,N[m]=0,h.minMoves&&(S===null&&(S={}),S[m]=h.minMoves),h.maxMoves&&(T===null&&(T={}),T[m]=h.maxMoves)),x={...x,activePlayers:O,_activePlayersMinMoves:S,_activePlayersMaxMoves:T,_activePlayersNumMoves:N},{...l,ctx:x}}function ct(l,{arg:h}){return{...l,ctx:At(l.ctx,h)}}function yo(l){return p.endIf(l)}function mo(l){return v(l.ctx).wrapped.endIf(l)}function vo(l){const h=v(l.ctx),m=l.ctx.numMoves||0;return h.turn.maxMoves&&m>=h.turn.maxMoves?!0:h.turn.wrapped.endIf(l)}function rn(l,{arg:h,phase:m}){l=Ee(l,{phase:m}),h===void 0&&(h=!0),l={...l,ctx:{...l.ctx,gameover:h}};const x=p.onEnd(l);return{...l,G:x}}function Ee(l,{arg:h,next:m,turn:x,automatic:O}){l=ut(l,{turn:x,force:!0,automatic:!0});const{phase:S,turn:T}=l.ctx;if(m&&m.push({fn:w,arg:h,phase:S}),S===null)return l;const Y=v(l.ctx).wrapped.onEnd(l),R={...l.ctx,phase:null},$=Ke("endPhase",h),{_stateID:U}=l,re={action:$,_stateID:U,turn:T,phase:S};O&&(re.automatic=!0);const Pe=[...l.deltalog||[],re];return{...l,G:Y,ctx:R,deltalog:Pe}}function ut(l,{arg:h,next:m,turn:x,force:O,automatic:S,playerID:T}){if(x!==l.ctx.turn)return l;const{currentPlayer:N,numMoves:Y,phase:R,turn:$}=l.ctx,U=v(l.ctx),re=Y||0;if(!O&&U.turn.minMoves&&re<U.turn.minMoves)return gs(`cannot end turn before making ${U.turn.minMoves} moves`),l;const Pe=U.turn.wrapped.onEnd(l);m&&m.push({fn:V,arg:h,currentPlayer:N});let me={...l.ctx,activePlayers:null};if(h&&h.remove){T=T||N;const we=me.playOrder.filter(Mo=>Mo!=T),Ao=me.playOrderPos>we.length-1?0:me.playOrderPos;if(me={...me,playOrder:we,playOrderPos:Ao},we.length===0)return m.push({fn:Ee,turn:$,phase:R}),l}const on=Ke("endTurn",h),{_stateID:wr}=l,qe={action:on,_stateID:wr,turn:$,phase:R};S&&(qe.automatic=!0);const an=[...l.deltalog||[],qe];return{...l,G:Pe,ctx:me,deltalog:an,_undo:[],_redo:[]}}function sn(l,{arg:h,next:m,automatic:x,playerID:O}){O=O||l.ctx.currentPlayer;let{ctx:S,_stateID:T}=l,{activePlayers:N,_activePlayersNumMoves:Y,_activePlayersMinMoves:R,_activePlayersMaxMoves:$,phase:U,turn:re}=S;const Pe=N!==null&&O in N,me=v(S);if(!h&&Pe){const we=me.turn.stages[N[O]];we&&we.next&&(h=we.next)}if(m&&m.push({fn:at,arg:h,playerID:O}),!Pe)return l;const on=Y[O]||0;if(R&&R[O]&&on<R[O])return gs(`cannot end stage before making ${R[O]} moves`),l;N={...N},delete N[O],R&&(R={...R},delete R[O]),$&&($={...$},delete $[O]),S=ga({...S,activePlayers:N,_activePlayersMinMoves:R,_activePlayersMaxMoves:$});const qe={action:Ke("endStage",h),_stateID:T,turn:re,phase:U};x&&(qe.automatic=!0);const an=[...l.deltalog||[],qe];return{...l,ctx:S,deltalog:an}}function Pr(l,h,m){const x=v(l),O=x.turn.stages,{activePlayers:S}=l;if(S&&S[m]!==void 0&&S[m]!==It.NULL&&O[S[m]]!==void 0&&O[S[m]].moves!==void 0){const N=O[S[m]].moves;if(h in N)return N[h]}else if(x.moves){if(h in x.moves)return x.moves[h]}else if(h in t)return t[h];return null}function go(l,h){const{playerID:m,type:x}=h,{currentPlayer:O,activePlayers:S,_activePlayersMaxMoves:T}=l.ctx,N=Pr(l.ctx,x,m),Y=!N||typeof N=="function"||N.noLimit!==!0;let{numMoves:R,_activePlayersNumMoves:$}=l.ctx;Y&&(m===O&&R++,S&&$[m]++),l={...l,ctx:{...l.ctx,numMoves:R,_activePlayersNumMoves:$}},T&&$[m]>=T[m]&&(l=sn(l,{playerID:m,automatic:!0}));const re=v(l.ctx).turn.wrapped.onMove({...l,ctx:{...l.ctx,playerID:m}});return l={...l,G:re},_(l,[{fn:E}])}function _o(l,h,m){return _(l,[{fn:sn,arg:m,playerID:h}])}function bo(l,h){return _(l,[{fn:sn,playerID:h}])}function Eo(l,h,m){return _(l,[{fn:ct,arg:m}])}function Po(l,h,m){return _(l,[{fn:Ee,phase:l.ctx.phase,turn:l.ctx.turn,arg:{next:m}}])}function wo(l){return _(l,[{fn:Ee,phase:l.ctx.phase,turn:l.ctx.turn}])}function So(l,h,m){return _(l,[{fn:ut,turn:l.ctx.turn,phase:l.ctx.phase,arg:m}])}function Oo(l,h,m){return _(l,[{fn:ut,turn:l.ctx.turn,phase:l.ctx.phase,force:!0,arg:m}])}function Co(l,h,m){return _(l,[{fn:rn,turn:l.ctx.turn,phase:l.ctx.phase,arg:m}])}const lt={endStage:bo,setStage:_o,endTurn:So,pass:Oo,endPhase:wo,setPhase:Po,endGame:Co,setActivePlayers:Eo},ue=[];i.endTurn!==!1&&ue.push("endTurn"),i.pass!==!1&&ue.push("pass"),i.endPhase!==!1&&ue.push("endPhase"),i.setPhase!==!1&&ue.push("setPhase"),i.endGame!==!1&&ue.push("endGame"),i.setActivePlayers!==!1&&ue.push("setActivePlayers"),i.endStage!==!1&&ue.push("endStage"),i.setStage!==!1&&ue.push("setStage");function ko(l,h){const{type:m,playerID:x,args:O}=h.payload;return typeof lt[m]!="function"?l:lt[m](l,x,...Array.isArray(O)?O:[O])}function xo(l,h,m){return h.activePlayers?m in h.activePlayers:h.currentPlayer===m}return{ctx:l=>({numPlayers:l,turn:0,currentPlayer:"0",playOrder:[...Array.from({length:l})].map((h,m)=>m+""),playOrderPos:0,phase:u,activePlayers:null}),init:l=>_(l,[{fn:P}]),isPlayerActive:xo,eventHandlers:lt,eventNames:Object.keys(lt),enabledEventNames:ue,moveMap:c,moveNames:[...f.values()],processMove:go,processEvent:ko,getMove:Pr}}function La(t){return t.processMove!==void 0}function Tt(t){if(La(t))return t;if(t.name===void 0&&(t.name="default"),t.deltaState===void 0&&(t.deltaState=!1),t.disableUndo===void 0&&(t.disableUndo=!1),t.setup===void 0&&(t.setup=()=>({})),t.moves===void 0&&(t.moves={}),t.playerView===void 0&&(t.playerView=n=>n),t.plugins===void 0&&(t.plugins=[]),t.plugins.forEach(n=>{if(n.name===void 0)throw new Error("Plugin missing name attribute");if(n.name.includes(" "))throw new Error(n.name+": Plugin name must not include spaces")}),t.name.includes(" "))throw new Error(t.name+": Game name must not include spaces");const e=$a(t);return{...t,flow:e,moveNames:e.moveNames,pluginNames:t.plugins.map(n=>n.name),processMove:(n,r)=>{let s=e.getMove(n.ctx,r.type,r.playerID);if(js(s)&&(s=s.move),s instanceof Function){const i=_s(s,B.MOVE,t.plugins),o={...Te(n),playerID:r.playerID};let a=[];return r.args!==void 0&&(a=Array.isArray(r.args)?r.args:[r.args]),i(n.G,o,...a)}return I(`invalid move object: ${r.type}`),n.G}}}function js(t){return t instanceof Object&&t.move!==void 0}var qn;(function(t){t.UnauthorizedAction="update/unauthorized_action",t.MatchNotFound="update/match_not_found",t.PatchFailed="update/patch_failed"})(qn||(qn={}));var j;(function(t){t.StaleStateId="action/stale_state_id",t.UnavailableMove="action/unavailable_move",t.InvalidMove="action/invalid_move",t.InactivePlayer="action/inactive_player",t.GameOver="action/gameover",t.ActionDisabled="action/action_disabled",t.ActionInvalid="action/action_invalid",t.PluginActionInvalid="action/plugin_invalid"})(j||(j={}));const Dt=t=>t.payload.playerID!==null&&t.payload.playerID!==void 0,Ba=(t,e,n)=>{function r(i){return i.undoable!==void 0}function s(i){return i instanceof Function}return r(n)?s(n.undoable)?n.undoable(t,e):n.undoable:!0};function Us(t,e){if(e.game.disableUndo)return t;const n={G:t.G,ctx:t.ctx,plugins:t.plugins,playerID:e.action.payload.playerID||t.ctx.currentPlayer};return e.action.type==="MAKE_MOVE"&&(n.moveType=e.action.payload.type),{...t,_undo:[...t._undo,n],_redo:[]}}function Hn(t,e,n){const r={action:e,_stateID:t._stateID,turn:t.ctx.turn,phase:t.ctx.phase},s=t.plugins.log.data.metadata;return s!==void 0&&(r.metadata=s),typeof n=="object"&&n.redact===!0&&(r.redact=!0),{...t,deltalog:[r]}}function Vn(t,e,n){const[r,s]=bs(t,n);return s?[r,F(e,j.PluginActionInvalid,s)]:[r]}function Gs(t){if(!t)return[null,void 0];const{transients:e,...n}=t;return[n,e]}function F(t,e,n){return{...t,transients:{error:{type:e,payload:n}}}}const Fs=t=>e=>n=>{const r=e(n);switch(n.type){case kt:return r;default:{const[,s]=Gs(t.getState());return typeof s!="undefined"?(t.dispatch(vs()),{...r,transients:s}):r}}};function Wn({game:t,isClient:e}){return t=Tt(t),(n=null,r)=>{let[s]=Gs(n);switch(r.type){case kt:return s;case St:{if(s={...s,deltalog:[]},e)return s;if(s.ctx.gameover!==void 0)return I("cannot call event after game end"),F(s,j.GameOver);if(Dt(r)&&!t.flow.isPlayerActive(s.G,s.ctx,r.payload.playerID))return I(`disallowed event: ${r.payload.type}`),F(s,j.InactivePlayer);s=Rn(s,{game:t,isClient:!1,playerID:r.payload.playerID});let i=t.flow.processEvent(s,r),o;return[i,o]=Vn(i,s,{game:t,isClient:!1}),o||(i=Us(i,{game:t,action:r}),{...i,_stateID:s._stateID+1})}case Je:{const i=s={...s,deltalog:[]},o=t.flow.getMove(s.ctx,r.payload.type,r.payload.playerID||s.ctx.currentPlayer);if(o===null)return I(`disallowed move: ${r.payload.type}`),F(s,j.UnavailableMove);if(e&&o.client===!1)return s;if(s.ctx.gameover!==void 0)return I("cannot make move after game end"),F(s,j.GameOver);if(Dt(r)&&!t.flow.isPlayerActive(s.G,s.ctx,r.payload.playerID))return I(`disallowed move: ${r.payload.type}`),F(s,j.InactivePlayer);s=Rn(s,{game:t,isClient:e,playerID:r.payload.playerID});const a=t.processMove(s,r.payload);if(a===Nn)return I(`invalid move: ${r.payload.type} args: ${r.payload.args}`),F(s,j.InvalidMove);const c={...s,G:a};if(e&&ma(c,{game:t}))return s;if(s=c,e){let u;return[s,u]=Vn(s,i,{game:t,isClient:!0}),u||{...s,_stateID:s._stateID+1}}s=Hn(s,r,o),s=t.flow.processMove(s,r.payload);let f;return[s,f]=Vn(s,i,{game:t}),f||(s=Us(s,{game:t,action:r}),{...s,_stateID:s._stateID+1})}case xn:case Mn:case An:return r.state;case Ct:{if(s={...s,deltalog:[]},t.disableUndo)return I("Undo is not enabled"),F(s,j.ActionDisabled);const{G:i,ctx:o,_undo:a,_redo:c,_stateID:f}=s;if(a.length<2)return I("No moves to undo"),F(s,j.ActionInvalid);const u=a[a.length-1],d=a[a.length-2];if(Dt(r)&&r.payload.playerID!==u.playerID)return I("Cannot undo other players' moves"),F(s,j.ActionInvalid);if(u.moveType){const y=t.flow.getMove(d.ctx,u.moveType,u.playerID);if(!Ba(i,o,y))return I("Move cannot be undone"),F(s,j.ActionInvalid)}return s=Hn(s,r),{...s,G:d.G,ctx:d.ctx,plugins:d.plugins,_stateID:f+1,_undo:a.slice(0,-1),_redo:[u,...c]}}case Ot:{if(s={...s,deltalog:[]},t.disableUndo)return I("Redo is not enabled"),F(s,j.ActionDisabled);const{_undo:i,_redo:o,_stateID:a}=s;if(o.length===0)return I("No moves to redo"),F(s,j.ActionInvalid);const c=o[0];return Dt(r)&&r.payload.playerID!==c.playerID?(I("Cannot redo other players' moves"),F(s,j.ActionInvalid)):(s=Hn(s,r),{...s,G:c.G,ctx:c.ctx,plugins:c.plugins,_stateID:a+1,_undo:[...i,c],_redo:o.slice(1)})}case cs:return da(s,r,{game:t});case In:{const i=s,o=JSON.parse(JSON.stringify(i)),a=$s(o,r.patch);return a.some(f=>f!==null)?(I(`Patch ${JSON.stringify(r.patch)} apply failed`),F(i,qn.PatchFailed,a)):o}default:return s}}}(function(t,e){if(t.setImmediate)return;var n=1,r={},s=!1,i=t.document,o;function a(g){typeof g!="function"&&(g=new Function(""+g));for(var C=new Array(arguments.length-1),w=0;w<C.length;w++)C[w]=arguments[w+1];var V={callback:g,args:C};return r[n]=V,o(n),n++}function c(g){delete r[g]}function f(g){var C=g.callback,w=g.args;switch(w.length){case 0:C();break;case 1:C(w[0]);break;case 2:C(w[0],w[1]);break;case 3:C(w[0],w[1],w[2]);break;default:C.apply(e,w);break}}function u(g){if(s)setTimeout(u,0,g);else{var C=r[g];if(C){s=!0;try{f(C)}finally{c(g),s=!1}}}}function d(){o=function(g){process.nextTick(function(){u(g)})}}function y(){if(t.postMessage&&!t.importScripts){var g=!0,C=t.onmessage;return t.onmessage=function(){g=!1},t.postMessage("","*"),t.onmessage=C,g}}function p(){var g="setImmediate$"+Math.random()+"$",C=function(w){w.source===t&&typeof w.data=="string"&&w.data.indexOf(g)===0&&u(+w.data.slice(g.length))};t.addEventListener?t.addEventListener("message",C,!1):t.attachEvent("onmessage",C),o=function(w){t.postMessage(g+w,"*")}}function v(){var g=new MessageChannel;g.port1.onmessage=function(C){var w=C.data;u(w)},o=function(C){g.port2.postMessage(C)}}function E(){var g=i.documentElement;o=function(C){var w=i.createElement("script");w.onreadystatechange=function(){u(C),w.onreadystatechange=null,g.removeChild(w),w=null},g.appendChild(w)}}function _(){o=function(g){setTimeout(u,0,g)}}var P=Object.getPrototypeOf&&Object.getPrototypeOf(t);P=P&&P.setTimeout?P:t,{}.toString.call(t.process)==="[object process]"?d():y()?p():t.MessageChannel?v():i&&"onreadystatechange"in i.createElement("script")?E():_(),P.setImmediate=a,P.clearImmediate=c})(typeof self=="undefined"?L:self);class ja{constructor({enumerate:e,seed:n}){this.enumerateFn=e,this.seed=n,this.iterationCounter=0,this._opts={}}addOpt({key:e,range:n,initial:r}){this._opts[e]={range:n,value:r}}getOpt(e){return this._opts[e].value}setOpt(e,n){e in this._opts&&(this._opts[e].value=n)}opts(){return this._opts}enumerate(e,n,r){return this.enumerateFn(e,n,r).map(i=>{if("payload"in i)return i;if("move"in i)return us(i.move,i.args,r);if("event"in i)return Ke(i.event,i.args,r)})}random(e){let n;if(this.seed!==void 0){const r=this.prngstate?"":this.seed,s=os(r,this.prngstate);n=s(),this.prngstate=s.state()}else n=Math.random();if(e)if(Array.isArray(e)){const r=Math.floor(n*e.length);return e[r]}else return Math.floor(n*e);return n}}const Ua=25;class Ga extends ja{constructor({enumerate:e,seed:n,objectives:r,game:s,iterations:i,playoutDepth:o,iterationCallback:a}){super({enumerate:e,seed:n});r===void 0&&(r=()=>({})),this.objectives=r,this.iterationCallback=a||(()=>{}),this.reducer=Wn({game:s}),this.iterations=i,this.playoutDepth=o,this.addOpt({key:"async",initial:!1}),this.addOpt({key:"iterations",initial:typeof i=="number"?i:1e3,range:{min:1,max:2e3}}),this.addOpt({key:"playoutDepth",initial:typeof o=="number"?o:50,range:{min:1,max:100}})}createNode({state:e,parentAction:n,parent:r,playerID:s}){const{G:i,ctx:o}=e;let a=[],c=[];if(s!==void 0)a=this.enumerate(i,o,s),c=this.objectives(i,o,s);else if(o.activePlayers)for(const f in o.activePlayers)a.push(...this.enumerate(i,o,f)),c.push(this.objectives(i,o,f));else a=this.enumerate(i,o,o.currentPlayer),c=this.objectives(i,o,o.currentPlayer);return{state:e,parent:r,parentAction:n,actions:a,objectives:c,children:[],visits:0,value:0}}select(e){if(e.actions.length>0||e.children.length===0)return e;let n=null,r=0;for(const s of e.children){const i=s.visits+Number.EPSILON,o=s.value/i+Math.sqrt(2*Math.log(e.visits)/i);(n==null||o>r)&&(r=o,n=s)}return this.select(n)}expand(e){const n=e.actions;if(n.length===0||e.state.ctx.gameover!==void 0)return e;const r=this.random(n.length),s=n[r];e.actions.splice(r,1);const i=this.reducer(e.state,s),o=this.createNode({state:i,parentAction:s,parent:e});return e.children.push(o),o}playout({state:e}){let n=this.getOpt("playoutDepth");typeof this.playoutDepth=="function"&&(n=this.playoutDepth(e.G,e.ctx));for(let r=0;r<n&&e.ctx.gameover===void 0;r++){const{G:s,ctx:i}=e;let o=i.currentPlayer;i.activePlayers&&(o=Object.keys(i.activePlayers)[0]);const a=this.enumerate(s,i,o),c=this.objectives(s,i,o),f=Object.keys(c).reduce((y,p)=>{const v=c[p];return v.checker(s,i)?y+v.weight:y},0);if(f>0)return{score:f};if(!a||a.length===0)return;const u=this.random(a.length);e=this.reducer(e,a[u])}return e.ctx.gameover}backpropagate(e,n={}){e.visits++,n.score!==void 0&&(e.value+=n.score),n.draw===!0&&(e.value+=.5),e.parentAction&&n.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,n)}play(e,n){const r=this.createNode({state:e,playerID:n});let s=this.getOpt("iterations");typeof this.iterations=="function"&&(s=this.iterations(e.G,e.ctx));const i=()=>{let o=null;for(const f of r.children)(o==null||f.visits>o.visits)&&(o=f);return{action:o&&o.parentAction,metadata:r}};return new Promise(o=>{const a=()=>{for(let c=0;c<Ua&&this.iterationCounter<s;c++){const f=this.select(r),u=this.expand(f),d=this.playout(u);this.backpropagate(u,d),this.iterationCounter++}this.iterationCallback({iterationCounter:this.iterationCounter,numIterations:s,metadata:r})};if(this.iterationCounter=0,this.getOpt("async")){const c=()=>{this.iterationCounter<s?(a(),setImmediate(c)):o(i())};c()}else{for(;this.iterationCounter<s;)a();o(i())}})}}function Fa(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Hs(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qs(Object(n),!0).forEach(function(r){Fa(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qs(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function J(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var Vs=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),zn=function(){return Math.random().toString(36).substring(7).split("").join(".")},Ws={INIT:"@@redux/INIT"+zn(),REPLACE:"@@redux/REPLACE"+zn(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+zn()}};function qa(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function Jn(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(J(0));if(typeof e=="function"&&typeof n=="undefined"&&(n=e,e=void 0),typeof n!="undefined"){if(typeof n!="function")throw new Error(J(1));return n(Jn)(t,e)}if(typeof t!="function")throw new Error(J(2));var s=t,i=e,o=[],a=o,c=!1;function f(){a===o&&(a=o.slice())}function u(){if(c)throw new Error(J(3));return i}function d(E){if(typeof E!="function")throw new Error(J(4));if(c)throw new Error(J(5));var _=!0;return f(),a.push(E),function(){if(!!_){if(c)throw new Error(J(6));_=!1,f();var g=a.indexOf(E);a.splice(g,1),o=null}}}function y(E){if(!qa(E))throw new Error(J(7));if(typeof E.type=="undefined")throw new Error(J(8));if(c)throw new Error(J(9));try{c=!0,i=s(i,E)}finally{c=!1}for(var _=o=a,P=0;P<_.length;P++){var g=_[P];g()}return E}function p(E){if(typeof E!="function")throw new Error(J(10));s=E,y({type:Ws.REPLACE})}function v(){var E,_=d;return E={subscribe:function(g){if(typeof g!="object"||g===null)throw new Error(J(11));function C(){g.next&&g.next(u())}C();var w=_(C);return{unsubscribe:w}}},E[Vs]=function(){return this},E}return y({type:Ws.INIT}),r={dispatch:y,subscribe:d,getState:u,replaceReducer:p},r[Vs]=v,r}function zs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,s){return function(){return r(s.apply(void 0,arguments))}})}function Js(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var s=r.apply(void 0,arguments),i=function(){throw new Error(J(15))},o={getState:s.getState,dispatch:function(){return i.apply(void 0,arguments)}},a=e.map(function(c){return c(o)});return i=zs.apply(void 0,a)(s.dispatch),Hs(Hs({},s),{},{dispatch:i})}}}function Ks({game:t,numPlayers:e,setupData:n}){t=Tt(t),e||(e=2);const r=t.flow.ctx(e);let s={G:{},ctx:r,plugins:{}};s=pa(s,{game:t}),s=Rn(s,{game:t,playerID:void 0});const i=Te(s);s.G=t.setup(i,n);let o={...s,_undo:[],_redo:[],_stateID:0};return o=t.flow.init(o),[o]=bs(o,{game:t}),t.disableUndo||(o._undo=[{G:o.G,ctx:o.ctx,plugins:o.plugins}]),o}class Kn{constructor({transportDataCallback:e,gameName:n,playerID:r,matchID:s,credentials:i,numPlayers:o}){this.connectionStatusCallback=()=>{},this.isConnected=!1,this.transportDataCallback=e,this.gameName=n||"default",this.playerID=r||null,this.matchID=s||"default",this.credentials=i,this.numPlayers=o||2}subscribeToConnectionStatus(e){this.connectionStatusCallback=e}setConnectionStatus(e){this.isConnected=e,this.connectionStatusCallback()}notifyClient(e){this.transportDataCallback(e)}}class Ha extends Kn{connect(){}disconnect(){}sendAction(){}sendChatMessage(){}requestSync(){}updateCredentials(){}updateMatchID(){}updatePlayerID(){}}const Va=t=>new Ha(t);class Wa{constructor(){this.debugPanel=null,this.currentClient=null,this.clients=new Map,this.subscribers=new Map}register(e){this.clients.set(e,e),this.mountDebug(e),this.notifySubscribers()}unregister(e){if(this.clients.delete(e),this.currentClient===e){this.unmountDebug();for(const[n]of this.clients){if(this.debugPanel)break;this.mountDebug(n)}}this.notifySubscribers()}subscribe(e){const n=Symbol();return this.subscribers.set(n,e),e(this.getState()),()=>{this.subscribers.delete(n)}}switchPlayerID(e){if(this.currentClient.multiplayer){for(const[n]of this.clients)if(n.playerID===e&&n.debugOpt!==!1&&n.multiplayer===this.currentClient.multiplayer){this.switchToClient(n);return}}this.currentClient.updatePlayerID(e),this.notifySubscribers()}switchToClient(e){e!==this.currentClient&&(this.unmountDebug(),this.mountDebug(e),this.notifySubscribers())}notifySubscribers(){const e=this.getState();this.subscribers.forEach(n=>{n(e)})}getState(){return{client:this.currentClient,debuggableClients:this.getDebuggableClients()}}getDebuggableClients(){return[...this.clients.values()].filter(e=>e.debugOpt!==!1)}mountDebug(e){if(e.debugOpt===!1||this.debugPanel!==null||typeof document=="undefined")return;let n,r=document.body;e.debugOpt&&e.debugOpt!==!0&&(n=e.debugOpt.impl||n,r=e.debugOpt.target||r),n&&(this.currentClient=e,this.debugPanel=new n({target:r,props:{clientManager:this}}))}unmountDebug(){this.debugPanel.$destroy(),this.debugPanel=null,this.currentClient=null}}const za=new Wa;function Yn(t,e,n){return!n&&t==null&&(t=e.getState().ctx.currentPlayer),t}function Qn(t,e,n,r,s,i){const o={};for(const a of e)o[a]=(...c)=>{const f=aa[t](a,c,Yn(r,n,i),s);n.dispatch(f)};return o}const Ja=Qn.bind(null,"makeMove"),Ka=Qn.bind(null,"gameEvent"),Ya=Qn.bind(null,"plugin");class Qa{constructor({game:e,debug:n,numPlayers:r,multiplayer:s,matchID:i,playerID:o,credentials:a,enhancer:c}){this.game=Tt(e),this.playerID=o,this.matchID=i||"default",this.credentials=a,this.multiplayer=s,this.debugOpt=n,this.manager=za,this.gameStateOverride=null,this.subscribers={},this._running=!1,this.reducer=Wn({game:this.game,isClient:s!==void 0}),this.initialState=null,s||(this.initialState=Ks({game:this.game,numPlayers:r})),this.reset=()=>{this.store.dispatch(ps(this.initialState))},this.undo=()=>{const p=ys(Yn(this.playerID,this.store,this.multiplayer),this.credentials);this.store.dispatch(p)},this.redo=()=>{const p=ms(Yn(this.playerID,this.store,this.multiplayer),this.credentials);this.store.dispatch(p)},this.log=[];const y=Js(Fs,()=>p=>v=>{const E=p(v);return this.notifySubscribers(),E},p=>v=>E=>{const _=p.getState(),P=v(E);return!("clientOnly"in E)&&E.type!==kt&&this.transport.sendAction(_,E),P},p=>v=>E=>{const _=v(E),P=p.getState();switch(E.type){case Je:case St:case Ct:case Ot:{const g=P.deltalog;this.log=[...this.log,...g];break}case xn:{this.log=[];break}case In:case Mn:{let g=-1;this.log.length>0&&(g=this.log[this.log.length-1]._stateID);let C=E.deltalog||[];C=C.filter(w=>w._stateID>g),this.log=[...this.log,...C];break}case An:{this.initialState=E.initialState,this.log=E.log||[];break}}return _});c=c!==void 0?zs(y,c):y,this.store=Jn(this.reducer,this.initialState,c),s||(s=Va),this.transport=s({transportDataCallback:p=>this.receiveTransportData(p),gameKey:e,game:this.game,matchID:i,playerID:o,credentials:a,gameName:this.game.name,numPlayers:r}),this.createDispatchers(),this.chatMessages=[],this.sendChatMessage=p=>{this.transport.sendChatMessage(this.matchID,{id:Go(7),sender:this.playerID,payload:p})}}receiveMatchData(e){this.matchData=e,this.notifySubscribers()}receiveChatMessage(e){this.chatMessages=[...this.chatMessages,e],this.notifySubscribers()}receiveTransportData(e){const[n]=e.args;if(n===this.matchID)switch(e.type){case"sync":{const[,r]=e.args,s=fs(r);this.receiveMatchData(r.filteredMetadata),this.store.dispatch(s);break}case"update":{const[,r,s]=e.args,i=this.store.getState();if(r._stateID>=i._stateID){const o=ds(r,s);this.store.dispatch(o)}break}case"patch":{const[,r,s,i,o]=e.args,a=this.store.getState()._stateID;if(r!==a)break;const c=hs(r,s,i,o);this.store.dispatch(c),this.store.getState()._stateID===a&&this.transport.requestSync();break}case"matchData":{const[,r]=e.args;this.receiveMatchData(r);break}case"chat":{const[,r]=e.args;this.receiveChatMessage(r);break}}}notifySubscribers(){Object.values(this.subscribers).forEach(e=>e(this.getState()))}overrideGameState(e){this.gameStateOverride=e,this.notifySubscribers()}start(){this.transport.connect(),this._running=!0,this.manager.register(this)}stop(){this.transport.disconnect(),this._running=!1,this.manager.unregister(this)}subscribe(e){const n=Object.keys(this.subscribers).length;return this.subscribers[n]=e,this.transport.subscribeToConnectionStatus(()=>this.notifySubscribers()),(this._running||!this.multiplayer)&&e(this.getState()),()=>{delete this.subscribers[n]}}getInitialState(){return this.initialState}getState(){let e=this.store.getState();if(this.gameStateOverride!==null&&(e=this.gameStateOverride),e===null)return e;let n=!0;const r=this.game.flow.isPlayerActive(e.G,e.ctx,this.playerID);return this.multiplayer&&!r&&(n=!1),!this.multiplayer&&this.playerID!==null&&this.playerID!==void 0&&!r&&(n=!1),e.ctx.gameover!==void 0&&(n=!1),this.multiplayer||(e={...e,G:this.game.playerView(e.G,e.ctx,this.playerID),plugins:Es(e,this)}),{...e,log:this.log,isActive:n,isConnected:this.transport.isConnected}}createDispatchers(){this.moves=Ja(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=Ka(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer),this.plugins=Ya(this.game.pluginNames,this.store,this.playerID,this.credentials,this.multiplayer)}updatePlayerID(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e),this.notifySubscribers()}updateMatchID(e){this.matchID=e,this.createDispatchers(),this.transport.updateMatchID(e),this.notifySubscribers()}updateCredentials(e){this.credentials=e,this.createDispatchers(),this.transport.updateCredentials(e),this.notifySubscribers()}}function Xa(t){return new Qa(t)}const Ys=(t,e)=>{if(!t||typeof t!="string")throw new Error(`Expected ${e} string, got "${t}".`)},ke=t=>Ys(t,"game name"),Xe=t=>Ys(t,"match ID"),Ze=(t,e)=>{if(!t)throw new Error(`Expected body, got \u201C${t}\u201D.`);for(const n in e){const r=e[n],s=Array.isArray(r)?r:[r],i=t[n];if(!s.includes(typeof i)){const o=s.join("|");throw new TypeError(`Expected body.${n} to be of type ${o}, got \u201C${i}\u201D.`)}}};class Za extends Error{constructor(e,n){super(e);this.details=n}}class ec{constructor({server:e=""}={}){this.server=e.replace(/\/$/,"")}async request(e,n){const r=await fetch(this.server+e,n);if(!r.ok){let s;try{s=await r.clone().json()}catch{try{s=await r.text()}catch(i){s=i.message}}throw new Za(`HTTP status ${r.status}`,s)}return r.json()}async post(e,n){let r={method:"post",body:JSON.stringify(n.body),headers:{"Content-Type":"application/json"}};return n.init&&(r={...r,...n.init,headers:{...r.headers,...n.init.headers}}),this.request(e,r)}async listGames(e){return this.request("/games",e)}async listMatches(e,n,r){ke(e);let s="";if(n){const i=[],{isGameover:o,updatedBefore:a,updatedAfter:c}=n;o!==void 0&&i.push(`isGameover=${o}`),a&&i.push(`updatedBefore=${a}`),c&&i.push(`updatedAfter=${c}`),i.length>0&&(s="?"+i.join("&"))}return this.request(`/games/${e}${s}`,r)}async getMatch(e,n,r){return ke(e),Xe(n),this.request(`/games/${e}/${n}`,r)}async createMatch(e,n,r){return ke(e),Ze(n,{numPlayers:"number"}),this.post(`/games/${e}/create`,{body:n,init:r})}async joinMatch(e,n,r,s){return ke(e),Xe(n),Ze(r,{playerID:["string","undefined"],playerName:"string"}),this.post(`/games/${e}/${n}/join`,{body:r,init:s})}async leaveMatch(e,n,r,s){ke(e),Xe(n),Ze(r,{playerID:"string",credentials:"string"}),await this.post(`/games/${e}/${n}/leave`,{body:r,init:s})}async updatePlayer(e,n,r,s){ke(e),Xe(n),Ze(r,{playerID:"string",credentials:"string"}),await this.post(`/games/${e}/${n}/update`,{body:r,init:s})}async playAgain(e,n,r,s){return ke(e),Xe(n),Ze(r,{playerID:"string",credentials:"string"}),this.post(`/games/${e}/${n}/playAgain`,{body:r,init:s})}}var Z={exports:{}},M={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Qs=Object.getOwnPropertySymbols,tc=Object.prototype.hasOwnProperty,nc=Object.prototype.propertyIsEnumerable;function rc(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function sc(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(r.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(i){s[i]=i}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Xs=sc()?Object.assign:function(t,e){for(var n,r=rc(t),s,i=1;i<arguments.length;i++){n=Object(arguments[i]);for(var o in n)tc.call(n,o)&&(r[o]=n[o]);if(Qs){s=Qs(n);for(var a=0;a<s.length;a++)nc.call(n,s[a])&&(r[s[a]]=n[s[a]])}}return r};/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xn=Xs,Re=60103,Zs=60106;M.Fragment=60107;M.StrictMode=60108;M.Profiler=60114;var ei=60109,ti=60110,ni=60112;M.Suspense=60113;var ri=60115,si=60116;if(typeof Symbol=="function"&&Symbol.for){var ee=Symbol.for;Re=ee("react.element"),Zs=ee("react.portal"),M.Fragment=ee("react.fragment"),M.StrictMode=ee("react.strict_mode"),M.Profiler=ee("react.profiler"),ei=ee("react.provider"),ti=ee("react.context"),ni=ee("react.forward_ref"),M.Suspense=ee("react.suspense"),ri=ee("react.memo"),si=ee("react.lazy")}var ii=typeof Symbol=="function"&&Symbol.iterator;function ic(t){return t===null||typeof t!="object"?null:(t=ii&&t[ii]||t["@@iterator"],typeof t=="function"?t:null)}function et(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oi={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ai={};function $e(t,e,n){this.props=t,this.context=e,this.refs=ai,this.updater=n||oi}$e.prototype.isReactComponent={};$e.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(et(85));this.updater.enqueueSetState(this,t,e,"setState")};$e.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ci(){}ci.prototype=$e.prototype;function Zn(t,e,n){this.props=t,this.context=e,this.refs=ai,this.updater=n||oi}var er=Zn.prototype=new ci;er.constructor=Zn;Xn(er,$e.prototype);er.isPureReactComponent=!0;var tr={current:null},ui=Object.prototype.hasOwnProperty,li={key:!0,ref:!0,__self:!0,__source:!0};function fi(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)ui.call(e,r)&&!li.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),f=0;f<a;f++)c[f]=arguments[f+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Re,type:t,key:i,ref:o,props:s,_owner:tr.current}}function oc(t,e){return{$$typeof:Re,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nr(t){return typeof t=="object"&&t!==null&&t.$$typeof===Re}function ac(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hi=/\/+/g;function rr(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ac(""+t.key):e.toString(36)}function Rt(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Re:case Zs:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+rr(o,0):r,Array.isArray(s)?(n="",t!=null&&(n=t.replace(hi,"$&/")+"/"),Rt(s,e,n,"",function(f){return f})):s!=null&&(nr(s)&&(s=oc(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(hi,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Array.isArray(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+rr(i,a);o+=Rt(i,e,n,c,s)}else if(c=ic(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+rr(i,a++),o+=Rt(i,e,n,c,s);else if(i==="object")throw e=""+t,Error(et(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e));return o}function $t(t,e,n){if(t==null)return t;var r=[],s=0;return Rt(t,r,"","",function(i){return e.call(n,i,s++)}),r}function cc(t){if(t._status===-1){var e=t._result;e=e(),t._status=0,t._result=e,e.then(function(n){t._status===0&&(n=n.default,t._status=1,t._result=n)},function(n){t._status===0&&(t._status=2,t._result=n)})}if(t._status===1)return t._result;throw t._result}var di={current:null};function he(){var t=di.current;if(t===null)throw Error(et(321));return t}var uc={ReactCurrentDispatcher:di,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:tr,IsSomeRendererActing:{current:!1},assign:Xn};M.Children={map:$t,forEach:function(t,e,n){$t(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return $t(t,function(){e++}),e},toArray:function(t){return $t(t,function(e){return e})||[]},only:function(t){if(!nr(t))throw Error(et(143));return t}};M.Component=$e;M.PureComponent=Zn;M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uc;M.cloneElement=function(t,e,n){if(t==null)throw Error(et(267,t));var r=Xn({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=tr.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)ui.call(e,c)&&!li.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var f=0;f<c;f++)a[f]=arguments[f+2];r.children=a}return{$$typeof:Re,type:t.type,key:s,ref:i,props:r,_owner:o}};M.createContext=function(t,e){return e===void 0&&(e=null),t={$$typeof:ti,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:ei,_context:t},t.Consumer=t};M.createElement=fi;M.createFactory=function(t){var e=fi.bind(null,t);return e.type=t,e};M.createRef=function(){return{current:null}};M.forwardRef=function(t){return{$$typeof:ni,render:t}};M.isValidElement=nr;M.lazy=function(t){return{$$typeof:si,_payload:{_status:-1,_result:t},_init:cc}};M.memo=function(t,e){return{$$typeof:ri,type:t,compare:e===void 0?null:e}};M.useCallback=function(t,e){return he().useCallback(t,e)};M.useContext=function(t,e){return he().useContext(t,e)};M.useDebugValue=function(){};M.useEffect=function(t,e){return he().useEffect(t,e)};M.useImperativeHandle=function(t,e,n){return he().useImperativeHandle(t,e,n)};M.useLayoutEffect=function(t,e){return he().useLayoutEffect(t,e)};M.useMemo=function(t,e){return he().useMemo(t,e)};M.useReducer=function(t,e,n){return he().useReducer(t,e,n)};M.useRef=function(t){return he().useRef(t)};M.useState=function(t){return he().useState(t)};M.version="17.0.2";Z.exports=M;var b=Z.exports,pi={exports:{}},lc="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",fc=lc,hc=fc;function yi(){}function mi(){}mi.resetWarningCache=yi;var dc=function(){function t(r,s,i,o,a,c){if(c!==hc){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:mi,resetWarningCache:yi};return n.PropTypes=n,n};pi.exports=dc();var oe=pi.exports,de={},sr={};/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */sr.parse=vc;sr.serialize=gc;var pc=decodeURIComponent,yc=encodeURIComponent,mc=/; */,Lt=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function vc(t,e){if(typeof t!="string")throw new TypeError("argument str must be a string");for(var n={},r=e||{},s=t.split(mc),i=r.decode||pc,o=0;o<s.length;o++){var a=s[o],c=a.indexOf("=");if(!(c<0)){var f=a.substr(0,c).trim(),u=a.substr(++c,a.length).trim();u[0]=='"'&&(u=u.slice(1,-1)),n[f]==null&&(n[f]=_c(u,i))}}return n}function gc(t,e,n){var r=n||{},s=r.encode||yc;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!Lt.test(t))throw new TypeError("argument name is invalid");var i=s(e);if(i&&!Lt.test(i))throw new TypeError("argument val is invalid");var o=t+"="+i;if(r.maxAge!=null){var a=r.maxAge-0;if(isNaN(a))throw new Error("maxAge should be a Number");o+="; Max-Age="+Math.floor(a)}if(r.domain){if(!Lt.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!Lt.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(typeof r.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.sameSite){var c=typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite;switch(c){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return o}function _c(t,e){try{return e(t)}catch{return t}}Object.defineProperty(de,"__esModule",{value:!0});var bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};de.load=bi;de.loadAll=Ei;de.select=Pi;de.save=wi;de.remove=Si;de.setRawCookie=ir;de.plugToRequest=Oi;var Ec=sr,Le=gi(Ec),Pc=Xs,vi=gi(Pc);function gi(t){return t&&t.__esModule?t:{default:t}}var Bt=typeof document=="undefined"||typeof process!="undefined"&&process.env&&!1,K={},ge=void 0;function _i(){return ge&&!ge.headersSent}function bi(t,e){var n=Bt?K:Le.default.parse(document.cookie),r=n&&n[t];if(typeof e=="undefined"&&(e=!r||r[0]!=="{"&&r[0]!=="["),!e)try{r=JSON.parse(r)}catch{}return r}function Ei(t){var e=Bt?K:Le.default.parse(document.cookie),n=e;if(typeof t=="undefined"&&(t=!n||n[0]!=="{"&&n[0]!=="["),!t)try{n=JSON.parse(n)}catch{}return n}function Pi(t){var e=Bt?K:Le.default.parse(document.cookie);return e?t?Object.keys(e).reduce(function(n,r){if(!t.test(r))return n;var s={};return s[r]=e[r],(0,vi.default)({},n,s)},{}):e:{}}function wi(t,e,n){K[t]=e,(typeof e=="undefined"?"undefined":bc(e))==="object"&&(K[t]=JSON.stringify(e)),Bt||(document.cookie=Le.default.serialize(t,K[t],n)),_i()&&ge.cookie&&ge.cookie(t,e,n)}function Si(t,e){delete K[t],typeof e=="undefined"?e={}:typeof e=="string"?e={path:e}:e=(0,vi.default)({},e),typeof document!="undefined"&&(e.expires=new Date(1970,1,1,0,0,1),e.maxAge=0,document.cookie=Le.default.serialize(t,"",e)),_i()&&ge.clearCookie&&ge.clearCookie(t,e)}function ir(t){t?K=Le.default.parse(t):K={}}function Oi(t,e){return t.cookie?K=t.cookie:t.cookies?K=t.cookies:t.headers&&t.headers.cookie?ir(t.headers.cookie):K={},ge=e,function(){ge=null,K={}}}var Ci=de.default={setRawCookie:ir,load:bi,loadAll:Ei,select:Pi,save:wi,remove:Si,plugToRequest:Oi},jt;(function(t){t[t.SYNC=0]="SYNC",t[t.ASYNC=1]="ASYNC"})(jt||(jt={}));function xe(t){return t.type()===jt.SYNC}class wc{type(){return jt.SYNC}connect(){}createMatch(e,n){if(this.createGame)return console.warn("The database connector does not implement a createMatch method.",`
Using the deprecated createGame method instead.`),this.createGame(e,n);console.error("The database connector does not implement a createMatch method.")}listMatches(e){if(this.listGames)return console.warn("The database connector does not implement a listMatches method.",`
Using the deprecated listGames method instead.`),this.listGames(e);console.error("The database connector does not implement a listMatches method.")}}const Sc=({game:t,unlisted:e,setupData:n,numPlayers:r})=>{const s={gameName:t.name,unlisted:!!e,players:{},createdAt:Date.now(),updatedAt:Date.now()};n!==void 0&&(s.setupData=n);for(let i=0;i<r;i++)s.players[i]={id:i};return s},Oc=({game:t,numPlayers:e,setupData:n,unlisted:r})=>{(!e||typeof e!="number")&&(e=2);const s=t.validateSetupData&&t.validateSetupData(n,e);if(s!==void 0)return{setupDataError:s};const i=Sc({game:t,numPlayers:e,setupData:n,unlisted:r}),o=Ks({game:t,numPlayers:e,setupData:n});return{metadata:i,initialState:o}},ki=t=>Object.values(t.players).map(e=>{const{credentials:n,...r}=e;return r}),Cc=t=>{const{credentials:e,...n}=t.payload;return{...t,payload:n}};class kc{constructor(e,n,r,s){this.game=Tt(e),this.storageAPI=n,this.transportAPI=r,this.subscribeCallback=()=>{},this.auth=s}subscribe(e){this.subscribeCallback=e}async onUpdate(e,n,r,s){if(!e||!e.payload)return{error:"missing action or action payload"};let i;if(xe(this.storageAPI)?{metadata:i}=this.storageAPI.fetch(r,{metadata:!0}):{metadata:i}=await this.storageAPI.fetch(r,{metadata:!0}),this.auth&&!await this.auth.authenticateCredentials({playerID:s,credentials:e.payload.credentials,metadata:i}))return{error:"unauthorized action"};const o=Cc(e),a=r;let c;if(xe(this.storageAPI)?{state:c}=this.storageAPI.fetch(a,{state:!0}):{state:c}=await this.storageAPI.fetch(a,{state:!0}),c===void 0)return I(`game not found, matchID=[${a}]`),{error:"game not found"};if(c.ctx.gameover!==void 0){I(`game over - matchID=[${a}] - playerID=[${s}] - action[${o.payload.type}]`);return}const f=Wn({game:this.game}),u=Js(Fs),d=Jn(f,c,u);if(o.type==Ct||o.type==Ot){const P=c.ctx.activePlayers!==null,g=c.ctx.currentPlayer===s;if(!P&&!g||P&&(c.ctx.activePlayers[s]===void 0||Object.keys(c.ctx.activePlayers).length>1)){I(`playerID=[${s}] cannot undo / redo right now`);return}}if(!this.game.flow.isPlayerActive(c.G,c.ctx,s)){I(`player not active - playerID=[${s}] - action[${o.payload.type}]`);return}const y=o.type==Je?this.game.flow.getMove(c.ctx,o.payload.type,s):null;if(o.type==Je&&!y){I(`move not processed - canPlayerMakeMove=false - playerID=[${s}] - action[${o.payload.type}]`);return}if(c._stateID!==n&&!(y&&js(y)&&y.ignoreStaleStateID)){I(`invalid stateID, was=[${n}], expected=[${c._stateID}] - playerID=[${s}] - action[${o.payload.type}]`);return}const p=d.getState();d.dispatch(o),c=d.getState(),this.subscribeCallback({state:c,action:o,matchID:r}),this.game.deltaState?this.transportAPI.sendAll({type:"patch",args:[r,n,p,c]}):this.transportAPI.sendAll({type:"update",args:[r,c]});const{deltalog:v,...E}=c;let _;if(i&&(i.gameover===void 0||i.gameover===null)&&(_={...i,updatedAt:Date.now()},c.ctx.gameover!==void 0&&(_.gameover=c.ctx.gameover)),xe(this.storageAPI))this.storageAPI.setState(a,E,v),_&&this.storageAPI.setMetadata(a,_);else{const P=[this.storageAPI.setState(a,E,v)];_&&P.push(this.storageAPI.setMetadata(a,_)),await Promise.all(P)}}async onSync(e,n,r,s=2){const i=e,o={state:!0,metadata:!0,log:!0,initialState:!0},a=xe(this.storageAPI)?this.storageAPI.fetch(i,o):await this.storageAPI.fetch(i,o);let{state:c,initialState:f,log:u,metadata:d}=a;if(this.auth&&n!==void 0&&n!==null&&!await this.auth.authenticateCredentials({playerID:n,credentials:r,metadata:d}))return{error:"unauthorized"};if(c===void 0){const v=Oc({game:this.game,unlisted:!0,numPlayers:s,setupData:void 0});if("setupDataError"in v)return{error:"game requires setupData"};f=c=v.initialState,d=v.metadata,this.subscribeCallback({state:c,matchID:e}),xe(this.storageAPI)?this.storageAPI.createMatch(i,{initialState:f,metadata:d}):await this.storageAPI.createMatch(i,{initialState:f,metadata:d})}const y=d?ki(d):void 0,p={state:c,log:u,filteredMetadata:y,initialState:f};this.transportAPI.send({playerID:n,type:"sync",args:[e,p]})}async onConnectionChange(e,n,r,s){const i=e;if(n==null)return;let o;if(xe(this.storageAPI)?{metadata:o}=this.storageAPI.fetch(i,{metadata:!0}):{metadata:o}=await this.storageAPI.fetch(i,{metadata:!0}),o===void 0)return I(`metadata not found for matchID=[${i}]`),{error:"metadata not found"};if(o.players[n]===void 0)return I(`Player not in the match, matchID=[${i}] playerID=[${n}]`),{error:"player not in the match"};if(this.auth&&!await this.auth.authenticateCredentials({playerID:n,credentials:r,metadata:o}))return{error:"unauthorized"};o.players[n].isConnected=s;const a=ki(o);this.transportAPI.sendAll({type:"matchData",args:[e,a]}),xe(this.storageAPI)?this.storageAPI.setMetadata(i,o):await this.storageAPI.setMetadata(i,o)}async onChatMessage(e,n,r){const s=e;if(this.auth){const{metadata:i}=await this.storageAPI.fetch(s,{metadata:!0});if(!(n&&typeof n.sender=="string"))return{error:"unauthorized"};if(!await this.auth.authenticateCredentials({playerID:n.sender,credentials:r,metadata:i}))return{error:"unauthorized"}}this.transportAPI.sendAll({type:"chat",args:[e,n]})}}const Ut=(t,e,n)=>({...n,G:t.playerView(n.G,n.ctx,e),plugins:Es(n,{playerID:e,game:t}),deltalog:void 0,_undo:[],_redo:[]}),xc=t=>(e,n)=>{switch(n.type){case"patch":{const[r,s,i,o]=n.args,a=or(o.deltalog,e),c=Ut(t,e,o),f=o._stateID,u=Ut(t,e,i),d=Ls(u,c);return{type:"patch",args:[r,s,f,d,a]}}case"update":{const[r,s]=n.args,i=or(s.deltalog,e),o=Ut(t,e,s);return{type:"update",args:[r,o,i]}}case"sync":{const[r,s]=n.args,i=Ut(t,e,s.state),o=or(s.log,e),a={...s,state:i,log:o};return{type:"sync",args:[r,a]}}default:return n}};function or(t,e){return t===void 0?t:t.map(n=>{if(e!==null&&+e==+n.action.payload.playerID||n.redact!==!0)return n;const r={...n.action.payload,args:null},s={...n,action:{...n.action,payload:r}},{redact:i,...o}=s;return o})}var Ac=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Mc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],ar=function(e){var n=e,r=e.indexOf("["),s=e.indexOf("]");r!=-1&&s!=-1&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));for(var i=Ac.exec(e||""),o={},a=14;a--;)o[Mc[a]]=i[a]||"";return r!=-1&&s!=-1&&(o.source=n,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Ic(o,o.path),o.queryKey=Nc(o,o.query),o};function Ic(t,e){var n=/\/{2,9}/g,r=e.replace(n,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&r.splice(0,1),e.substr(e.length-1,1)=="/"&&r.splice(r.length-1,1),r}function Nc(t,e){var n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,s,i){s&&(n[s]=i)}),n}function Tc(t,e="",n){let r=t;n=n||typeof location!="undefined"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n!="undefined"?t=n.protocol+"//"+t:t="https://"+t),r=ar(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+e,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}var cr={exports:{}};try{cr.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch{cr.exports=!1}var Dc=cr.exports,_e=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())();function xi(t){const e=t.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!e||Dc))return new XMLHttpRequest}catch{}if(!e)try{return new _e[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function Ai(t,...e){return e.reduce((n,r)=>(t.hasOwnProperty(r)&&(n[r]=t[r]),n),{})}const Rc=setTimeout,$c=clearTimeout;function Gt(t,e){e.useNativeTimers?(t.setTimeoutFn=Rc.bind(_e),t.clearTimeoutFn=$c.bind(_e)):(t.setTimeoutFn=setTimeout.bind(_e),t.clearTimeoutFn=clearTimeout.bind(_e))}var Be=q;function q(t){if(t)return Lc(t)}function Lc(t){for(var e in q.prototype)t[e]=q.prototype[e];return t}q.prototype.on=q.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};q.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};q.prototype.off=q.prototype.removeListener=q.prototype.removeAllListeners=q.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var r,s=0;s<n.length;s++)if(r=n[s],r===e||r.fn===e){n.splice(s,1);break}return n.length===0&&delete this._callbacks["$"+t],this};q.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,s=n.length;r<s;++r)n[r].apply(this,e)}return this};q.prototype.emitReserved=q.prototype.emit;q.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};q.prototype.hasListeners=function(t){return!!this.listeners(t).length};const ae=Object.create(null);ae.open="0";ae.close="1";ae.ping="2";ae.pong="3";ae.message="4";ae.upgrade="5";ae.noop="6";const Ft=Object.create(null);Object.keys(ae).forEach(t=>{Ft[ae[t]]=t});const Bc={type:"error",data:"parser error"},jc=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Uc=typeof ArrayBuffer=="function",Gc=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Mi=({type:t,data:e},n,r)=>jc&&e instanceof Blob?n?r(e):Ii(e,r):Uc&&(e instanceof ArrayBuffer||Gc(e))?n?r(e):Ii(new Blob([e]),r):r(ae[t]+(e||"")),Ii=(t,e)=>{const n=new FileReader;return n.onload=function(){const r=n.result.split(",")[1];e("b"+r)},n.readAsDataURL(t)};var Ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tt=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(var qt=0;qt<Ni.length;qt++)tt[Ni.charCodeAt(qt)]=qt;var Fc=function(t){var e=t.length*.75,n=t.length,r,s=0,i,o,a,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var f=new ArrayBuffer(e),u=new Uint8Array(f);for(r=0;r<n;r+=4)i=tt[t.charCodeAt(r)],o=tt[t.charCodeAt(r+1)],a=tt[t.charCodeAt(r+2)],c=tt[t.charCodeAt(r+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|a>>2,u[s++]=(a&3)<<6|c&63;return f};const qc=typeof ArrayBuffer=="function",Ti=(t,e)=>{if(typeof t!="string")return{type:"message",data:Di(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:Hc(t.substring(1),e)}:Ft[n]?t.length>1?{type:Ft[n],data:t.substring(1)}:{type:Ft[n]}:Bc},Hc=(t,e)=>{if(qc){const n=Fc(t);return Di(n,e)}else return{base64:!0,data:t}},Di=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}},Ri=String.fromCharCode(30),Vc=(t,e)=>{const n=t.length,r=new Array(n);let s=0;t.forEach((i,o)=>{Mi(i,!1,a=>{r[o]=a,++s===n&&e(r.join(Ri))})})},Wc=(t,e)=>{const n=t.split(Ri),r=[];for(let s=0;s<n.length;s++){const i=Ti(n[s],e);if(r.push(i),i.type==="error")break}return r},$i=4;class Li extends Be{constructor(e){super();this.writable=!1,Gt(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,n){const r=new Error(e);return r.type="TransportError",r.description=n,super.emit("error",r),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emit("open")}onData(e){const n=Ti(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emit("packet",e)}onClose(){this.readyState="closed",super.emit("close")}}var Bi="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Ht=64,ji={},Ui=0,be=0,Gi;function ur(t){var e="";do e=Bi[t%Ht]+e,t=Math.floor(t/Ht);while(t>0);return e}function zc(t){var e=0;for(be=0;be<t.length;be++)e=e*Ht+ji[t.charAt(be)];return e}function lr(){var t=ur(+new Date);return t!==Gi?(Ui=0,Gi=t):t+"."+ur(Ui++)}for(;be<Ht;be++)ji[Bi[be]]=be;lr.encode=ur;lr.decode=zc;var Fi=lr,nt={};nt.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e};nt.decode=function(t){for(var e={},n=t.split("&"),r=0,s=n.length;r<s;r++){var i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e};class Jc extends Li{constructor(){super(...arguments);this.polling=!1}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||n()})),this.writable||(r++,this.once("drain",function(){--r||n()}))}else n()}poll(){this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){const n=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose(),!1;this.onPacket(r)};Wc(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Vc(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{};const n=this.opts.secure?"https":"http";let r="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Fi()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(n==="https"&&Number(this.opts.port)!==443||n==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);const s=nt.encode(e),i=this.opts.hostname.indexOf(":")!==-1;return n+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(s.length?"?"+s:"")}}function Kc(){}const Yc=function(){return new xi({xdomain:!1}).responseType!=null}();class Qc extends Jc{constructor(e){super(e);if(typeof location!="undefined"){const r=location.protocol==="https:";let s=location.port;s||(s=r?"443":"80"),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||s!==e.port,this.xs=e.secure!==r}const n=e&&e.forceBase64;this.supportsBinary=Yc&&!n}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new ce(this.uri(),e)}doWrite(e,n){const r=this.request({method:"POST",data:e});r.on("success",n),r.on("error",s=>{this.onError("xhr post error",s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",n=>{this.onError("xhr poll error",n)}),this.pollXhr=e}}class ce extends Be{constructor(e,n){super();Gt(this,n),this.opts=n,this.method=n.method||"GET",this.uri=e,this.async=n.async!==!1,this.data=n.data!==void 0?n.data:null,this.create()}create(){const e=Ai(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const n=this.xhr=new xi(e);try{n.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this.opts.extraHeaders[r])}}catch{}if(this.method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{n.readyState===4&&(n.status===200||n.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof n.status=="number"?n.status:0)},0))},n.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document!="undefined"&&(this.index=ce.requestsCount++,ce.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=Kc,e)try{this.xhr.abort()}catch{}typeof document!="undefined"&&delete ce.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&this.onData(e)}abort(){this.cleanup()}}ce.requestsCount=0;ce.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",qi);else if(typeof addEventListener=="function"){const t="onpagehide"in _e?"pagehide":"unload";addEventListener(t,qi,!1)}}function qi(){for(let t in ce.requests)ce.requests.hasOwnProperty(t)&&ce.requests[t].abort()}const Xc=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0))(),rt=_e.WebSocket||_e.MozWebSocket,Hi=!0,Zc="arraybuffer",Vi=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class fr extends Li{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),n=this.opts.protocols,r=Vi?{}:Ai(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Hi&&!Vi?n?new rt(e,n):new rt(e):new rt(e,n,r)}catch(s){return this.emit("error",s)}this.ws.binaryType=this.socket.binaryType||Zc,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const r=e[n],s=n===e.length-1;Mi(r,this.supportsBinary,i=>{const o={};try{Hi&&this.ws.send(i)}catch{}s&&Xc(()=>{this.writable=!0,this.emit("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const n=this.opts.secure?"wss":"ws";let r="";this.opts.port&&(n==="wss"&&Number(this.opts.port)!==443||n==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Fi()),this.supportsBinary||(e.b64=1);const s=nt.encode(e),i=this.opts.hostname.indexOf(":")!==-1;return n+"://"+(i?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(s.length?"?"+s:"")}check(){return!!rt&&!("__initialize"in rt&&this.name===fr.prototype.name)}}const eu={websocket:fr,polling:Qc};class pe extends Be{constructor(e,n={}){super();e&&typeof e=="object"&&(n=e,e=null),e?(e=ar(e),n.hostname=e.host,n.secure=e.protocol==="https"||e.protocol==="wss",n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=ar(n.host).host),Gt(this,n),this.secure=n.secure!=null?n.secure:typeof location!="undefined"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=n.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},n),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=nt.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const n=tu(this.opts.query);n.EIO=$i,n.transport=e,this.id&&(n.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new eu[e](r)}open(){let e;if(this.opts.rememberUpgrade&&pe.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){let n=this.createTransport(e),r=!1;pe.priorWebsocketSuccess=!1;const s=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",d=>{if(!r)if(d.type==="pong"&&d.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;pe.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const y=new Error("probe error");y.transport=n.name,this.emitReserved("upgradeError",y)}}))};function i(){r||(r=!0,u(),n.close(),n=null)}const o=d=>{const y=new Error("probe error: "+d);y.transport=n.name,i(),this.emitReserved("upgradeError",y)};function a(){o("transport closed")}function c(){o("socket closed")}function f(d){n&&d.name!==n.name&&i()}const u=()=>{n.removeListener("open",s),n.removeListener("error",o),n.removeListener("close",a),this.off("close",c),this.off("upgrading",f)};n.once("open",s),n.once("error",o),n.once("close",a),this.once("close",c),this.once("upgrading",f),n.open()}onOpen(){if(this.readyState="open",pe.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let e=0;const n=this.upgrades.length;for(;e<n;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const n=new Error("server error");n.code=e.data,this.onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emitReserved("flush"))}write(e,n,r){return this.sendPacket("message",e,n,r),this}send(e,n,r){return this.sendPacket("message",e,n,r),this}sendPacket(e,n,r,s){if(typeof n=="function"&&(s=n,n=void 0),typeof r=="function"&&(s=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const i={type:e,data:n,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),s&&this.once("flush",s),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){pe.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,n){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const n=[];let r=0;const s=e.length;for(;r<s;r++)~this.transports.indexOf(e[r])&&n.push(e[r]);return n}}pe.protocol=$i;function tu(t){const e={};for(let n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}pe.protocol;const nu=typeof ArrayBuffer=="function",ru=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Wi=Object.prototype.toString,su=typeof Blob=="function"||typeof Blob!="undefined"&&Wi.call(Blob)==="[object BlobConstructor]",iu=typeof File=="function"||typeof File!="undefined"&&Wi.call(File)==="[object FileConstructor]";function hr(t){return nu&&(t instanceof ArrayBuffer||ru(t))||su&&t instanceof Blob||iu&&t instanceof File}function Vt(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(Vt(t[n]))return!0;return!1}if(hr(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Vt(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Vt(t[n]))return!0;return!1}function ou(t){const e=[],n=t.data,r=t;return r.data=dr(n,e),r.attachments=e.length,{packet:r,buffers:e}}function dr(t,e){if(!t)return t;if(hr(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=dr(t[r],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=dr(t[r],e));return n}return t}function au(t,e){return t.data=pr(t.data,e),t.attachments=void 0,t}function pr(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=pr(t[n],e);else if(typeof t=="object")for(const n in t)t.hasOwnProperty(n)&&(t[n]=pr(t[n],e));return t}const cu=5;var A;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(A||(A={}));class uu{encode(e){return(e.type===A.EVENT||e.type===A.ACK)&&Vt(e)?(e.type=e.type===A.EVENT?A.BINARY_EVENT:A.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===A.BINARY_EVENT||e.type===A.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data)),n}encodeAsBinary(e){const n=ou(e),r=this.encodeAsString(n.packet),s=n.buffers;return s.unshift(r),s}}class yr extends Be{constructor(){super()}add(e){let n;if(typeof e=="string")n=this.decodeString(e),n.type===A.BINARY_EVENT||n.type===A.BINARY_ACK?(this.reconstructor=new fu(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n);else if(hr(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const r={type:Number(e.charAt(0))};if(A[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===A.BINARY_EVENT||r.type===A.BINARY_ACK){const i=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const o=e.substring(i,n);if(o!=Number(o)||e.charAt(n)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););r.nsp=e.substring(i,n)}else r.nsp="/";const s=e.charAt(n+1);if(s!==""&&Number(s)==s){const i=n+1;for(;++n;){const o=e.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===e.length)break}r.id=Number(e.substring(i,n+1))}if(e.charAt(++n)){const i=lu(e.substr(n));if(yr.isPayloadValid(r.type,i))r.data=i;else throw new Error("invalid payload")}return r}static isPayloadValid(e,n){switch(e){case A.CONNECT:return typeof n=="object";case A.DISCONNECT:return n===void 0;case A.CONNECT_ERROR:return typeof n=="string"||typeof n=="object";case A.EVENT:case A.BINARY_EVENT:return Array.isArray(n)&&n.length>0;case A.ACK:case A.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}function lu(t){try{return JSON.parse(t)}catch{return!1}}class fu{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=au(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var hu=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",protocol:cu,get PacketType(){return A},Encoder:uu,Decoder:yr});function te(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const du=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class zi extends Be{constructor(e,n,r){super();this.connected=!1,this.disconnected=!0,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const e=this.io;this.subs=[te(e,"open",this.onopen.bind(this)),te(e,"packet",this.onpacket.bind(this)),te(e,"error",this.onerror.bind(this)),te(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){if(du.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');n.unshift(e);const r={type:A.EVENT,data:n};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const o=this.ids++,a=n.pop();this._registerAckCallback(o,a),r.id=o}const s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?this.packet(r):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,n){const r=this.flags.timeout;if(r===void 0){this.acks[e]=n;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===e&&this.sendBuffer.splice(i,1);n.call(this,new Error("operation has timed out"))},r);this.acks[e]=(...i)=>{this.io.clearTimeoutFn(s),n.apply(this,[null,...i])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this.packet({type:A.CONNECT,data:e})}):this.packet({type:A.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case A.CONNECT:if(e.data&&e.data.sid){const s=e.data.sid;this.onconnect(s)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case A.EVENT:this.onevent(e);break;case A.BINARY_EVENT:this.onevent(e);break;case A.ACK:this.onack(e);break;case A.BINARY_ACK:this.onack(e);break;case A.DISCONNECT:this.ondisconnect();break;case A.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const r of n)r.apply(this,e)}super.emit.apply(this,e)}ack(e){const n=this;let r=!1;return function(...s){r||(r=!0,n.packet({type:A.ACK,id:e,data:s}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(n.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:A.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let r=0;r<n.length;r++)if(e===n[r])return n.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}var pu=je;function je(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}je.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-n:t+n}return Math.min(t,this.max)|0};je.prototype.reset=function(){this.attempts=0};je.prototype.setMin=function(t){this.ms=t};je.prototype.setMax=function(t){this.max=t};je.prototype.setJitter=function(t){this.jitter=t};class mr extends Be{constructor(e,n){var r;super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Gt(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((r=n.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new pu({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const s=n.parser||hu;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new pe(this.uri,this.opts);const n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const s=te(n,"open",function(){r.onopen(),e&&e()}),i=te(n,"error",o=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",o),e?e(o):r.maybeReconnectOnOpen()});if(this._timeout!==!1){const o=this._timeout;o===0&&s();const a=this.setTimeoutFn(()=>{s(),n.close(),n.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(s),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(te(e,"ping",this.onping.bind(this)),te(e,"data",this.ondata.bind(this)),te(e,"error",this.onerror.bind(this)),te(e,"close",this.onclose.bind(this)),te(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){this.emitReserved("error",e)}socket(e,n){let r=this.nsps[e];return r||(r=new zi(this,e,n),this.nsps[e]=r),r}_destroy(e){const n=Object.keys(this.nsps);for(const r of n)if(this.nsps[r].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let r=0;r<n.length;r++)this.engine.write(n[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(s=>{s?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",s)):e.onreconnect()}))},n);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const st={};function Wt(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=Tc(t,e.path||"/socket.io"),r=n.source,s=n.id,i=n.path,o=st[s]&&i in st[s].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return a?c=new mr(r,e):(st[s]||(st[s]=new mr(r,e)),c=st[s]),n.query&&!e.query&&(e.query=n.queryKey),c.socket(n.path,e)}Object.assign(Wt,{Manager:mr,Socket:zi,io:Wt,connect:Wt});class Ji extends wc{constructor(){super();this.state=new Map,this.initial=new Map,this.metadata=new Map,this.log=new Map}createMatch(e,n){this.initial.set(e,n.initialState),this.setState(e,n.initialState),this.setMetadata(e,n.metadata)}setMetadata(e,n){this.metadata.set(e,n)}setState(e,n,r){if(r&&r.length>0){const s=this.log.get(e)||[];this.log.set(e,[...s,...r])}this.state.set(e,n)}fetch(e,n){const r={};return n.state&&(r.state=this.state.get(e)),n.metadata&&(r.metadata=this.metadata.get(e)),n.log&&(r.log=this.log.get(e)||[]),n.initialState&&(r.initialState=this.initial.get(e)),r}wipe(e){this.state.delete(e),this.metadata.delete(e)}listMatches(e){return[...this.metadata.entries()].filter(([,n])=>e?!(e.gameName!==void 0&&n.gameName!==e.gameName||e.where!==void 0&&(e.where.isGameover!==void 0&&n.gameover!==void 0!==e.where.isGameover||e.where.updatedBefore!==void 0&&n.updatedAt>=e.where.updatedBefore||e.where.updatedAfter!==void 0&&n.updatedAt<=e.where.updatedAfter)):!0).map(([n])=>n)}}class yu extends Map{constructor(e){super();this.key=e,(JSON.parse(localStorage.getItem(this.key))||[]).forEach(r=>this.set(...r))}sync(){const e=[...this.entries()];localStorage.setItem(this.key,JSON.stringify(e))}set(e,n){return super.set(e,n),this.sync(),this}delete(e){const n=super.delete(e);return this.sync(),n}}class mu extends Ji{constructor(e="bgio"){super();const n=r=>new yu(`${e}_${r}`);this.state=n("state"),this.initial=n("initial"),this.metadata=n("metadata"),this.log=n("log")}}function vu(t,e){if(t.ctx.gameover!==void 0)return null;if(t.ctx.activePlayers){for(const n of Object.keys(e))if(n in t.ctx.activePlayers)return n}else if(t.ctx.currentPlayer in e)return t.ctx.currentPlayer;return null}class gu extends kc{constructor({game:e,bots:n,storageKey:r,persist:s}){const i={},o={};if(e&&e.ai&&n)for(const d in n){const y=n[d];o[d]=new y({game:e,enumerate:e.ai.enumerate,seed:e.seed})}const a=({playerID:d,...y})=>{const p=i[d];p!==void 0&&p(c(d,y))},c=xc(e),f={send:a,sendAll:d=>{for(const y in i)a({playerID:y,...d})}},u=s?new mu(r):new Ji;super(e,u,f);this.connect=(d,y)=>{i[d]=y},this.subscribe(({state:d,matchID:y})=>{if(!n)return;const p=vu(d,o);p!==null&&setTimeout(async()=>{const v=await o[p].play(d,p);await this.onUpdate(v.action,d._stateID,y,v.action.payload.playerID)},100)})}}class _u extends Kn{constructor({master:e,...n}){super(n);this.master=e}sendChatMessage(e,n){const r=[e,n,this.credentials];this.master.onChatMessage(...r)}sendAction(e,n){this.master.onUpdate(n,e._stateID,this.matchID,this.playerID)}requestSync(){this.master.onSync(this.matchID,this.playerID,this.credentials,this.numPlayers)}connect(){this.setConnectionStatus(!0),this.master.connect(this.playerID,e=>this.notifyClient(e)),this.requestSync()}disconnect(){this.setConnectionStatus(!1)}updateMatchID(e){this.matchID=e,this.connect()}updatePlayerID(e){this.playerID=e,this.connect()}updateCredentials(e){this.credentials=e,this.connect()}}const Ki=new Map;function bu({bots:t,persist:e,storageKey:n}={}){return r=>{const{gameKey:s,game:i}=r;let o;const a=Ki.get(s);return a&&a.bots===t&&a.storageKey===n&&a.persist===e&&(o=a.master),o||(o=new gu({game:i,bots:t,persist:e,storageKey:n}),Ki.set(s,{master:o,bots:t,persist:e,storageKey:n})),new _u({master:o,...r})}}const Yi=Wt;class Eu extends Kn{constructor({socket:e,socketOpts:n,server:r,...s}){super(s);this.server=r,this.socket=e,this.socketOpts=n}sendAction(e,n){const r=[n,e._stateID,this.matchID,this.playerID];this.socket.emit("update",...r)}sendChatMessage(e,n){const r=[e,n,this.credentials];this.socket.emit("chat",...r)}connect(){if(!this.socket)if(this.server){let e=this.server;e.search(/^https?:\/\//)==-1&&(e="http://"+this.server),e.slice(-1)!="/"&&(e=e+"/"),this.socket=Yi(e+this.gameName,this.socketOpts)}else this.socket=Yi("/"+this.gameName,this.socketOpts);this.socket.on("patch",(e,n,r,s,i)=>{this.notifyClient({type:"patch",args:[e,n,r,s,i]})}),this.socket.on("update",(e,n,r)=>{this.notifyClient({type:"update",args:[e,n,r]})}),this.socket.on("sync",(e,n)=>{this.notifyClient({type:"sync",args:[e,n]})}),this.socket.on("matchData",(e,n)=>{this.notifyClient({type:"matchData",args:[e,n]})}),this.socket.on("chat",(e,n)=>{this.notifyClient({type:"chat",args:[e,n]})}),this.socket.on("connect",()=>{this.requestSync(),this.setConnectionStatus(!0)}),this.socket.on("disconnect",()=>{this.setConnectionStatus(!1)})}disconnect(){this.socket.close(),this.socket=null,this.setConnectionStatus(!1)}requestSync(){if(this.socket){const e=[this.matchID,this.playerID,this.credentials,this.numPlayers];this.socket.emit("sync",...e)}}updateMatchID(e){this.matchID=e,this.requestSync()}updatePlayerID(e){this.playerID=e,this.requestSync()}updateCredentials(e){this.credentials=e,this.requestSync()}}function Qi({server:t,socketOpts:e}={}){return n=>new Eu({server:t,socketOpts:e,...n})}function Pu(t){var e;const{game:n,numPlayers:r,board:s,multiplayer:i,enhancer:o}=t;let{loading:a,debug:c}=t;return a===void 0&&(a=()=>b.createElement("div",{className:"bgio-loading"},"connecting...")),e=class extends b.Component{constructor(u){super(u);c===void 0&&(c=u.debug),this.client=Xa({game:n,debug:c,numPlayers:r,multiplayer:i,matchID:u.matchID,playerID:u.playerID,credentials:u.credentials,enhancer:o})}componentDidMount(){this.unsubscribe=this.client.subscribe(()=>this.forceUpdate()),this.client.start()}componentWillUnmount(){this.client.stop(),this.unsubscribe()}componentDidUpdate(u){this.props.matchID!=u.matchID&&this.client.updateMatchID(this.props.matchID),this.props.playerID!=u.playerID&&this.client.updatePlayerID(this.props.playerID),this.props.credentials!=u.credentials&&this.client.updateCredentials(this.props.credentials)}render(){const u=this.client.getState();if(u===null)return b.createElement(a);let d=null;return s&&(d=b.createElement(s,{...u,...this.props,isMultiplayer:!!i,moves:this.client.moves,events:this.client.events,matchID:this.client.matchID,playerID:this.client.playerID,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo,log:this.client.log,matchData:this.client.matchData,sendChatMessage:this.client.sendChatMessage,chatMessages:this.client.chatMessages})),b.createElement("div",{className:"bgio-client"},d)}},e.propTypes={matchID:oe.string,playerID:oe.string,credentials:oe.string,debug:oe.any},e.defaultProps={matchID:"default",playerID:null,credentials:null,debug:!0},e}class wu{constructor({server:e,gameComponents:n,playerName:r,playerCredentials:s}){this.client=new ec({server:e}),this.gameComponents=n,this.playerName=r||"Visitor",this.playerCredentials=s,this.matches=[]}async refresh(){try{this.matches=[];const e=await this.client.listGames();for(const n of e){if(!this._getGameComponents(n))continue;const{matches:r}=await this.client.listMatches(n);this.matches.push(...r)}}catch(e){throw new Error("failed to retrieve list of matches ("+e+")")}}_getMatchInstance(e){for(const n of this.matches)if(n.matchID===e)return n}_getGameComponents(e){for(const n of this.gameComponents)if(n.game.name===e)return n}_findPlayer(e){for(const n of this.matches)if(n.players.some(r=>r.name===e))return n}async join(e,n,r){try{let s=this._findPlayer(this.playerName);if(s)throw new Error("player has already joined "+s.matchID);if(s=this._getMatchInstance(n),!s)throw new Error("game instance "+n+" not found");const i=await this.client.joinMatch(e,n,{playerID:r,playerName:this.playerName});s.players[Number.parseInt(r)].name=this.playerName,this.playerCredentials=i.playerCredentials}catch(s){throw new Error("failed to join match "+n+" ("+s+")")}}async leave(e,n){try{const r=this._getMatchInstance(n);if(!r)throw new Error("match instance not found");for(const s of r.players)if(s.name===this.playerName){await this.client.leaveMatch(e,n,{playerID:s.id.toString(),credentials:this.playerCredentials}),delete s.name,delete this.playerCredentials;return}throw new Error("player not found in match")}catch(r){throw new Error("failed to leave match "+n+" ("+r+")")}}async disconnect(){const e=this._findPlayer(this.playerName);e&&await this.leave(e.gameName,e.matchID),this.matches=[],this.playerName="Visitor"}async create(e,n){try{const r=this._getGameComponents(e);if(!r)throw new Error("game not found");if(n<r.game.minPlayers||n>r.game.maxPlayers)throw new Error("invalid number of players "+n);await this.client.createMatch(e,{numPlayers:n})}catch(r){throw new Error("failed to create match for "+e+" ("+r+")")}}}function Su(t){return new wu(t)}class Xi extends b.Component{constructor(){super(...arguments);this.state={playerName:this.props.playerName,nameErrorMsg:""},this.onClickEnter=()=>{this.state.playerName!==""&&this.props.onEnter(this.state.playerName)},this.onKeyPress=e=>{e.key==="Enter"&&this.onClickEnter()},this.onChangePlayerName=e=>{const n=e.target.value.trim();this.setState({playerName:n,nameErrorMsg:n.length>0?"":"empty player name"})}}render(){return b.createElement("div",null,b.createElement("p",{className:"phase-title"},"Choose a player name:"),b.createElement("input",{type:"text",value:this.state.playerName,onChange:this.onChangePlayerName,onKeyPress:this.onKeyPress}),b.createElement("span",{className:"buttons"},b.createElement("button",{className:"buttons",onClick:this.onClickEnter},"Enter")),b.createElement("br",null),b.createElement("span",{className:"error-msg"},this.state.nameErrorMsg,b.createElement("br",null)))}}Xi.defaultProps={playerName:""};class Ou extends b.Component{constructor(){super(...arguments);this._createSeat=e=>e.name||"[free]",this._createButtonJoin=(e,n)=>b.createElement("button",{key:"button-join-"+e.matchID,onClick:()=>this.props.onClickJoin(e.gameName,e.matchID,""+n)},"Join"),this._createButtonLeave=e=>b.createElement("button",{key:"button-leave-"+e.matchID,onClick:()=>this.props.onClickLeave(e.gameName,e.matchID)},"Leave"),this._createButtonPlay=(e,n)=>b.createElement("button",{key:"button-play-"+e.matchID,onClick:()=>this.props.onClickPlay(e.gameName,{matchID:e.matchID,playerID:""+n,numPlayers:e.players.length})},"Play"),this._createButtonSpectate=e=>b.createElement("button",{key:"button-spectate-"+e.matchID,onClick:()=>this.props.onClickPlay(e.gameName,{matchID:e.matchID,numPlayers:e.players.length})},"Spectate"),this._createInstanceButtons=e=>{const n=e.players.find(s=>s.name===this.props.playerName),r=e.players.find(s=>!s.name);return n&&r?this._createButtonLeave(e):r?this._createButtonJoin(e,r.id):n?b.createElement("div",null,[this._createButtonPlay(e,n.id),this._createButtonLeave(e)]):this._createButtonSpectate(e)}}render(){const e=this.props.match;let n="OPEN";return e.players.some(r=>!r.name)||(n="RUNNING"),b.createElement("tr",{key:"line-"+e.matchID},b.createElement("td",{key:"cell-name-"+e.matchID},e.gameName),b.createElement("td",{key:"cell-status-"+e.matchID},n),b.createElement("td",{key:"cell-seats-"+e.matchID},e.players.map(r=>this._createSeat(r)).join(", ")),b.createElement("td",{key:"cell-buttons-"+e.matchID},this._createInstanceButtons(e)))}}class Cu extends b.Component{constructor(e){super(e);this.state={selectedGame:0,numPlayers:2},this._createGameNameOption=(n,r)=>b.createElement("option",{key:"name-option-"+r,value:r},n.game.name),this._createNumPlayersOption=n=>b.createElement("option",{key:"num-option-"+n,value:n},n),this._createNumPlayersRange=n=>Array.from({length:n.maxPlayers+1}).map((r,s)=>s).slice(n.minPlayers),this.onChangeNumPlayers=n=>{this.setState({numPlayers:Number.parseInt(n.target.value)})},this.onChangeSelectedGame=n=>{const r=Number.parseInt(n.target.value);this.setState({selectedGame:r,numPlayers:this.props.games[r].game.minPlayers})},this.onClickCreate=()=>{this.props.createMatch(this.props.games[this.state.selectedGame].game.name,this.state.numPlayers)};for(const n of e.games){const r=n.game;r.minPlayers||(r.minPlayers=1),r.maxPlayers||(r.maxPlayers=4),console.assert(r.maxPlayers>=r.minPlayers)}this.state={selectedGame:0,numPlayers:e.games[0].game.minPlayers}}render(){return b.createElement("div",null,b.createElement("select",{value:this.state.selectedGame,onChange:e=>this.onChangeSelectedGame(e)},this.props.games.map((e,n)=>this._createGameNameOption(e,n))),b.createElement("span",null,"Players:"),b.createElement("select",{value:this.state.numPlayers,onChange:this.onChangeNumPlayers},this._createNumPlayersRange(this.props.games[this.state.selectedGame].game).map(e=>this._createNumPlayersOption(e))),b.createElement("span",{className:"buttons"},b.createElement("button",{onClick:this.onClickCreate},"Create")))}}var H;(function(t){t.ENTER="enter",t.PLAY="play",t.LIST="list"})(H||(H={}));class Zi extends b.Component{constructor(e){super(e);this.state={phase:H.ENTER,playerName:"Visitor",runningMatch:null,errorMsg:"",credentialStore:{}},this._createConnection=n=>{const r=this.state.playerName;this.connection=Su({server:n.lobbyServer,gameComponents:n.gameComponents,playerName:r,playerCredentials:this.state.credentialStore[r]})},this._updateCredentials=(n,r)=>{this.setState(s=>{const i=Object.assign({},s.credentialStore);return i[n]=r,{credentialStore:i}})},this._updateConnection=async()=>{await this.connection.refresh(),this.forceUpdate()},this._enterLobby=n=>{this._startRefreshInterval(),this.setState({playerName:n,phase:H.LIST})},this._exitLobby=async()=>{this._clearRefreshInterval(),await this.connection.disconnect(),this.setState({phase:H.ENTER,errorMsg:""})},this._createMatch=async(n,r)=>{try{await this.connection.create(n,r),await this.connection.refresh(),this.setState({})}catch(s){this.setState({errorMsg:s.message})}},this._joinMatch=async(n,r,s)=>{try{await this.connection.join(n,r,s),await this.connection.refresh(),this._updateCredentials(this.connection.playerName,this.connection.playerCredentials)}catch(i){this.setState({errorMsg:i.message})}},this._leaveMatch=async(n,r)=>{try{await this.connection.leave(n,r),await this.connection.refresh(),this._updateCredentials(this.connection.playerName,this.connection.playerCredentials)}catch(s){this.setState({errorMsg:s.message})}},this._startMatch=(n,r)=>{const s=this.connection._getGameComponents(n);if(!s){this.setState({errorMsg:"game "+n+" not supported"});return}let i;if(r.numPlayers>1&&(i=this.props.gameServer?Qi({server:this.props.gameServer}):Qi()),r.numPlayers==1){const c=s.game.maxPlayers,f={};for(let u=1;u<c;u++)f[u+""]=Ga;i=bu({bots:f})}const a={app:this.props.clientFactory({game:s.game,board:s.board,debug:this.props.debug,multiplayer:i}),matchID:r.matchID,playerID:r.numPlayers>1?r.playerID:"0",credentials:this.connection.playerCredentials};this._clearRefreshInterval(),this.setState({phase:H.PLAY,runningMatch:a})},this._exitMatch=()=>{this._startRefreshInterval(),this.setState({phase:H.LIST,runningMatch:null})},this._getPhaseVisibility=n=>this.state.phase!==n?"hidden":"phase",this.renderMatches=(n,r)=>n.map(s=>{const{matchID:i,gameName:o,players:a}=s;return b.createElement(Ou,{key:"instance-"+i,match:{matchID:i,gameName:o,players:Object.values(a)},playerName:r,onClickJoin:this._joinMatch,onClickLeave:this._leaveMatch,onClickPlay:this._startMatch})}),this._createConnection(this.props)}componentDidMount(){const e=Ci.load("lobbyState")||{};e.phase&&e.phase===H.PLAY&&(e.phase=H.LIST),e.phase&&e.phase!==H.ENTER&&this._startRefreshInterval(),this.setState({phase:e.phase||H.ENTER,playerName:e.playerName||"Visitor",credentialStore:e.credentialStore||{}})}componentDidUpdate(e,n){const r=this.state.playerName,s=this.state.credentialStore[r];if(n.phase!==this.state.phase||n.credentialStore[r]!==s||n.playerName!==r){this._createConnection(this.props),this._updateConnection();const i={phase:this.state.phase,playerName:r,credentialStore:this.state.credentialStore};Ci.save("lobbyState",i,{path:"/"})}e.refreshInterval!==this.props.refreshInterval&&this._startRefreshInterval()}componentWillUnmount(){this._clearRefreshInterval()}_startRefreshInterval(){this._clearRefreshInterval(),this._currentInterval=setInterval(this._updateConnection,this.props.refreshInterval)}_clearRefreshInterval(){clearInterval(this._currentInterval)}render(){const{gameComponents:e,renderer:n}=this.props,{errorMsg:r,playerName:s,phase:i,runningMatch:o}=this.state;return n?n({errorMsg:r,gameComponents:e,matches:this.connection.matches,phase:i,playerName:s,runningMatch:o,handleEnterLobby:this._enterLobby,handleExitLobby:this._exitLobby,handleCreateMatch:this._createMatch,handleJoinMatch:this._joinMatch,handleLeaveMatch:this._leaveMatch,handleExitMatch:this._exitMatch,handleRefreshMatches:this._updateConnection,handleStartMatch:this._startMatch}):b.createElement("div",{id:"lobby-view",style:{padding:50}},b.createElement("div",{className:this._getPhaseVisibility(H.ENTER)},b.createElement(Xi,{key:s,playerName:s,onEnter:this._enterLobby})),b.createElement("div",{className:this._getPhaseVisibility(H.LIST)},b.createElement("p",null,"Welcome, ",s),b.createElement("div",{className:"phase-title",id:"match-creation"},b.createElement("span",null,"Create a match:"),b.createElement(Cu,{games:e,createMatch:this._createMatch})),b.createElement("p",{className:"phase-title"},"Join a match:"),b.createElement("div",{id:"instances"},b.createElement("table",null,b.createElement("tbody",null,this.renderMatches(this.connection.matches,s))),b.createElement("span",{className:"error-msg"},r,b.createElement("br",null))),b.createElement("p",{className:"phase-title"},"Matches that become empty are automatically deleted.")),b.createElement("div",{className:this._getPhaseVisibility(H.PLAY)},o&&b.createElement(o.app,{matchID:o.matchID,playerID:o.playerID,credentials:o.credentials}),b.createElement("div",{className:"buttons",id:"match-exit"},b.createElement("button",{onClick:this._exitMatch},"Exit match"))),b.createElement("div",{className:"buttons",id:"lobby-exit"},b.createElement("button",{onClick:this._exitLobby},"Exit lobby")))}}Zi.propTypes={gameComponents:oe.array.isRequired,lobbyServer:oe.string,gameServer:oe.string,debug:oe.bool,clientFactory:oe.func,refreshInterval:oe.number};Zi.defaultProps={debug:!1,clientFactory:Pu,refreshInterval:2e3};var vr={},zt={},ku=L&&L.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};Object.defineProperty(zt,"__esModule",{value:!0});zt.Timeline=void 0;const eo="(?:\\d*\\.?\\d+|\\d+\\.?\\d*)?",xu=RegExp(`^\\^(${eo})(->(${eo})?)?$`),Au=t=>{const e=xu.exec(t);return{position:e&&e[1]?parseFloat(e[1]):0,shift:e&&e[3]?parseFloat(e[3]):void 0}};class Mu{constructor(){this._last=null,this._keyframes=new Map,this._duration=0}isEmpty(){return this._keyframes.size===0}duration(){return this._duration}keys(){return[...this._keyframes.keys()].sort((e,n)=>e<n?-1:1)}shift(e,n){const r=this.keys();for(let s=r.length-1;s>=0;s--){const i=r[s];if(i>=n){const o=this._keyframes.get(i);this._keyframes.delete(i),this._keyframes.set(i+e,o)}}this._last&&(this._last+=e),this._duration&&(this._duration+=e)}add(e,n=this._duration,r=0){let s;if(typeof n=="string"){n=n.trim();const o=n.slice(0,1),a=o==="<";if(a||o===">"){const c=a?this._last||0:this._duration,f=parseFloat(n.slice(1)||"0");n=c+f}else o==="^"&&({position:n,shift:s}=Au(n),s===void 0&&(s=r))}if(typeof n!="number")throw new Error(`Couldn\u2019t parse position argument \u201C${n}\u201D`);s&&this.shift(s,n);const i=this._keyframes.get(n)||[];this._keyframes.set(n,[...i,Object.assign({duration:r},e)]),(this._last===null||n>this._last)&&(this._last=n),n+r>this._duration&&(this._duration=n+r)}getQueue(){const e=[{t:0,endT:0,type:"effects:start"}];return this.keys().forEach(n=>{this._keyframes.get(n).forEach(s=>{const{duration:i}=s,o=ku(s,["duration"]);e.push(Object.assign({t:n,endT:n+i},o))})}),e.push({t:this._duration,endT:this._duration,type:"effects:end"}),e}clear(){this._last=null,this._keyframes.clear(),this._duration=0}}zt.Timeline=Mu;Object.defineProperty(vr,"__esModule",{value:!0});var Iu=vr.EffectsPlugin=void 0;const to=zt,Nu="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Tu=()=>{let t="",e=8;for(;e--;)t+=Nu[Math.random()*64|0];return t},no=t=>({id:Tu(),duration:t.duration(),queue:t.getQueue()}),Du=t=>({name:"effects",setup:()=>no(new to.Timeline),api:()=>{const n={timeline:new to.Timeline};for(const r in t.effects){if(r==="timeline")throw new RangeError("Cannot create effect type \u201Ctimeline\u201D. Name is reserved.");const{create:s,duration:i}=t.effects[r];n[r]=(...o)=>{const a=s?{type:r,payload:s(o[0])}:{type:r},[c,f=i]=s?o.slice(1):o;n.timeline.add(a,c,f)}}return n},flush:({api:n})=>no(n.timeline)});Iu=vr.EffectsPlugin=Du;var Ru={},Jt={},ne={};Object.defineProperty(ne,"__esModule",{value:!0});ne.EffectsPropsContext=ne.EffectsQueueContext=ne.EffectsContext=void 0;const gr=Z.exports;ne.EffectsContext=(0,gr.createContext)(null);ne.EffectsQueueContext=(0,gr.createContext)(void 0);ne.EffectsPropsContext=(0,gr.createContext)(void 0);var Ue={},ro=function(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(s){s(n)}),(r=t.get("*"))&&r.slice().map(function(s){s(e,n)})}}},so={},it={},$u=L&&L.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(it,"__esModule",{value:!0});it.Store=void 0;const Lu=$u(ro);class Ae{constructor(e){this.value=e,this.mitt=(0,Lu.default)()}get hasSubscribers(){const e=this.mitt.all.get(Ae.Event);return e!==void 0&&e.length>0}subscribe(e){return this.mitt.on(Ae.Event,e),e(this.value),()=>this.mitt.off(Ae.Event,e)}set(e){this.value!==e&&(this.value=e,this.mitt.emit(Ae.Event,e))}get(){return this.value}}it.Store=Ae;Ae.Event="change";var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.ComputedStore=void 0;const Bu=it;class ju extends Bu.Store{constructor(e,n){super(n(e.get()));this.store=e,this.selector=n}start(){this.unsubscribe||(this.unsubscribe=this.store.subscribe(e=>{this.set(this.selector(e))}))}stop(){!this.unsubscribe||this.hasSubscribers||(this.unsubscribe(),delete this.unsubscribe)}subscribe(e){this.start();const n=super.subscribe(e);return()=>{n(),this.stop()}}get(){return this.selector(this.store.get())}}Kt.ComputedStore=ju;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ComputedStore=t.Store=void 0;var e=it;Object.defineProperty(t,"Store",{enumerable:!0,get:function(){return e.Store}});var n=Kt;Object.defineProperty(t,"ComputedStore",{enumerable:!0,get:function(){return n.ComputedStore}})})(so);var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.RafRunner=void 0;class Uu{constructor(e){this.callback=e,this.running=!1}requestFrame(e){this.raf=requestAnimationFrame(e),this.timeout=setTimeout(e,1e3)}cancelFrames(){this.raf&&cancelAnimationFrame(this.raf),this.timeout&&clearTimeout(this.timeout)}start(){if(this.running)return;const e=()=>{!this.running||(this.cancelFrames(),this.callback(),this.requestFrame(e))};this.running=!0,this.requestFrame(e)}stop(){this.running=!1,this.cancelFrames()}}Yt.RafRunner=Uu;var Gu=L&&L.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.EffectsEmitter=Ue.InternalEffectsEmitter=void 0;const io=Gu(ro),_r=so,Fu=Yt;class qu{constructor(e=1,n=!1){this.speed=e,this.updateStateAfterEffects=n,this.emitter=(0,io.default)(),this.endEmitter=(0,io.default)(),this.raf=new Fu.RafRunner(()=>this.onRaf()),this.queue=new _r.Store([]),this.activeQueue=[],this.latestState=null,this.startT=0,this.duration=0,this.state=new _r.Store(null),this.size=new _r.ComputedStore(this.queue,r=>r.length)}on(e,n,r){let s;n&&(s=e==="*"?(o,{payload:a,boardProps:c})=>n(o,a,c):({payload:o,boardProps:a})=>n(o,a),this.emitter.on(e,s));let i;return r&&(i=e==="*"?(o,{payload:a,boardProps:c})=>r(o,a,c):({payload:o,boardProps:a})=>r(o,a),this.endEmitter.on(e,i)),()=>this.off(e,s,i)}off(e,n,r){this.emitter.off(e,n),this.endEmitter.off(e,r)}clear(){this.raf.stop(),this.emitAllEffects(this.endEmitter,this.activeQueue),this.queue.set([]),this.activeQueue=[],this.state.set(this.latestState)}flush(){const e=this.queue.get();this.emitAllEffects(this.emitter,e),this.activeQueue=[...this.activeQueue,...e],this.clear()}onUpdate(e){this.flush();const n=this.latestState;if(this.latestState=e,!e||!e.plugins.effects||!n||!n.plugins.effects||e.plugins.effects.data.id===n.plugins.effects.data.id){this.state.set(e);return}this.queue.set(e.plugins.effects.data.queue),this.activeQueue=[],this.startT=performance.now(),this.duration=e.plugins.effects.data.duration,this.raf.start()}onRaf(){const e=(performance.now()-this.startT)/1e3*this.speed,n=[];let r=!1;for(const a of this.activeQueue){if(a.endT>e){n.push(a);continue}this.emit(this.endEmitter,a),r=!0}const s=this.queue.get();let i=0;for(i=0;i<s.length;i++){const a=s[i];if(a.t>e)break;this.emit(this.emitter,a),n.push(a)}const o=this.updateStateAfterEffects?this.duration:0;e>=o&&this.state.get()!==this.latestState&&this.state.set(this.latestState),e>this.duration&&this.raf.stop(),i>0&&this.queue.set(s.slice(i)),(i>0||r)&&(this.activeQueue=n)}emit(e,{type:n,payload:r}){const s={payload:r,boardProps:this.latestState};e.emit(n,s)}emitAllEffects(e,n){for(const r of n)this.emit(e,r)}}function oo({speed:t,updateStateAfterEffects:e}={}){return new qu(t,e)}Ue.InternalEffectsEmitter=oo;function Hu(t,e){const n=oo(e);return t.subscribe(n.onUpdate.bind(n)),n}Ue.EffectsEmitter=Hu;var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.useStore=void 0;const ao=Z.exports;function Vu(t){const[e,n]=(0,ao.useState)(t.get());return(0,ao.useEffect)(()=>t.subscribe(n),[t]),e}Qt.useStore=Vu;var Wu=L&&L.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var s=Object.getOwnPropertyDescriptor(e,n);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,s)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),zu=L&&L.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ju=L&&L.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&Wu(e,t,n);return zu(e,t),e};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.EffectsBoardWrapper=void 0;const ye=Ju(Z.exports),br=ne,Ku=Ue,co=Qt;function Yu(t,e){return function(r){return Qu({boardProps:r,Board:t,opts:e})}}Jt.EffectsBoardWrapper=Yu;function Qu({Board:t,boardProps:e,opts:n}){const[r]=(0,ye.useState)(()=>{const a=(0,Ku.InternalEffectsEmitter)(n);return a.onUpdate(e),a});(0,ye.useEffect)(()=>r.onUpdate(e),[e,r]);const s={clear:(0,ye.useCallback)(()=>r.clear(),[r]),flush:(0,ye.useCallback)(()=>r.flush(),[r]),update:(0,ye.useCallback)(()=>{r.state.set(e)},[r.state,e]),size:(0,co.useStore)(r.size)},i=(0,co.useStore)(r.state),o=(n==null?void 0:n.updateStateAfterEffects)?i:e;return ye.default.createElement(br.EffectsContext.Provider,{value:r},ye.default.createElement(br.EffectsQueueContext.Provider,{value:s},ye.default.createElement(br.EffectsPropsContext.Provider,{value:o},ye.default.createElement(t,Object.assign({},o)))))}var Ge={},Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.hookErrorMessage=void 0;const Xu=t=>t+` must be called inside the effects context provider.
Make sure your board component has been correctly wrapped using EffectsBoardWrapper.`;Fe.hookErrorMessage=Xu;Object.defineProperty(Ge,"__esModule",{value:!0});Ge.useEffectListener=void 0;const Xt=Z.exports,Zu=ne,el=Fe;function tl(){}function nl(t,e,n,r,s,i=[]){s=s||tl;const o=(0,Xt.useCallback)(n,[...r,e]),a=(0,Xt.useCallback)(s,[...i,e]);(0,Xt.useEffect)(()=>{let c;const f=(...p)=>{typeof c=="function"&&c(),c=o(...p)};let u;const d=(...p)=>{typeof u=="function"&&u(),u=a(...p)},y=t.on(e,f,d);return()=>{y(),typeof c=="function"&&c(),typeof u=="function"&&u()}},[e,t,o,a])}function rl(...t){const e=(0,Xt.useContext)(Zu.EffectsContext),[n,r,s,i,o]=t;if(!e)throw new Error((0,el.hookErrorMessage)("useEffectListener"));if(!s)throw new TypeError("useEffectListener must receive a dependency list as its third argument.");if(i&&!o)throw new TypeError("useEffectListener must receive a dependency list as its fifth argument when using an onEffectEnd callback.");nl(e,n,r,s,i,o)}Ge.useEffectListener=rl;var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.useEffectQueue=void 0;const sl=Z.exports,il=ne,ol=Fe;function al(){const t=(0,sl.useContext)(il.EffectsQueueContext);if(!t)throw new Error((0,ol.hookErrorMessage)("useEffectQueue"));return t}Zt.useEffectQueue=al;var en={};Object.defineProperty(en,"__esModule",{value:!0});en.useEffectState=void 0;const uo=Z.exports,cl=Ge;function ul(t,e,n){const[r,s]=(0,uo.useState)(e),[i,o]=(0,uo.useState)(!1);return(0,cl.useEffectListener)(t,a=>{s(a),o(!0)},[],()=>o(!1),[]),[r,i]}en.useEffectState=ul;var tn={},nn={};Object.defineProperty(nn,"__esModule",{value:!0});nn.useBoardProps=void 0;const ll=Z.exports,fl=ne,hl=Fe;function dl(){const t=(0,ll.useContext)(fl.EffectsPropsContext);if(!t)throw new Error((0,hl.hookErrorMessage)("useBoardProps"));return t}nn.useBoardProps=dl;Object.defineProperty(tn,"__esModule",{value:!0});tn.useLatestPropsOnEffect=void 0;const Er=Z.exports,pl=Ge,yl=nn;function ml(...t){const e=(0,yl.useBoardProps)(),[n,r]=(0,Er.useState)(e),s=(0,Er.useRef)(t);return(t.length!==s.current.length||!s.current.every((i,o)=>i===t[o]))&&(s.current=t),(0,pl.useEffectListener)("*",(i,o,a)=>{(s.current.includes(i)||s.current.includes("*"))&&r(a)},[s]),(0,Er.useEffect)(()=>{r(e)},[e]),n}tn.useLatestPropsOnEffect=ml;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.useLatestPropsOnEffect=t.useEffectState=t.useEffectQueue=t.useEffectListener=t.EffectsBoardWrapper=void 0;var e=Jt;Object.defineProperty(t,"EffectsBoardWrapper",{enumerable:!0,get:function(){return e.EffectsBoardWrapper}});var n=Ge;Object.defineProperty(t,"useEffectListener",{enumerable:!0,get:function(){return n.useEffectListener}});var r=Zt;Object.defineProperty(t,"useEffectQueue",{enumerable:!0,get:function(){return r.useEffectQueue}});var s=en;Object.defineProperty(t,"useEffectState",{enumerable:!0,get:function(){return s.useEffectState}});var i=tn;Object.defineProperty(t,"useLatestPropsOnEffect",{enumerable:!0,get:function(){return i.useLatestPropsOnEffect}})})(Ru);var lo={exports:{}},ot={};/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vl=Z.exports,fo=60103;ot.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var ho=Symbol.for;fo=ho("react.element"),ot.Fragment=ho("react.fragment")}var gl=vl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_l=Object.prototype.hasOwnProperty,bl={key:!0,ref:!0,__self:!0,__source:!0};function po(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_l.call(e,r)&&!bl.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:fo,type:t,key:i,ref:o,props:s,_owner:gl.current}}ot.jsx=po;ot.jsxs=po;lo.exports=ot;var El=lo.exports;const{jsx:xl,jsxs:Al,Fragment:Ml}=El;async function Il(t,e,n){var r,s;const i=document.querySelectorAll(`astro-root[uid="${t}"]`),o=(s=(r=i[0].querySelector("astro-fragment"))==null?void 0:r.innerHTML)!=null?s:null,a=async()=>{const c=await n();for(const f of i)c(f,o)};if(e.value){const c=matchMedia(e.value);c.matches?a():c.addEventListener("change",a,{once:!0})}}async function Nl(t,e,n){var r,s;const i=document.querySelectorAll(`astro-root[uid="${t}"]`),o=(s=(r=i[0].querySelector("astro-fragment"))==null?void 0:r.innerHTML)!=null?s:null,a=async()=>{const f=await n();for(const u of i)f(u,o)},c=new IntersectionObserver(f=>{for(const u of f)if(!!u.isIntersecting){c.disconnect(),a();break}});for(const f of i)for(let u=0;u<f.children.length;u++){const d=f.children[u];c.observe(d)}}export{Pu as C,Iu as E,Ml as F,b as R,Pl as S,xl as a,Z as b,Nl as c,pt as d,Cl as e,Xs as f,Al as j,wl as l,Il as o,Ru as r,Ol as s,No as v,Sl as y};
